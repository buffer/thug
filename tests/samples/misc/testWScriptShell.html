<html>
<body>
<script>
	var WshShell = new ActiveXObject("WScript.shell");
	
	alert("valueOf: " + WshShell.valueOf());
	alert("toString: " + WshShell.toString());
	
	WshShell.Sleep(1);

	var System = WshShell.Environment("System");
	alert(WshShell.ExpandEnvironmentStrings("Windows is installed in %WinDir%"));
	alert(WshShell.ExpandEnvironmentStrings("Username: %USERNAME%"));
	alert(WshShell.ExpandEnvironmentStrings("Computer name: %COMPUTERNAME%"));
	alert(WshShell.ExpandEnvironmentStrings("OS: %OS%"));
	alert(WshShell.ExpandEnvironmentStrings("CommonProgramFiles: %CommonProgramFiles%"));

	WshShell.Echo("Echo test");

	alert(WshShell.SpecialFolders("AllUsersDesktop"));
	alert(WshShell.SpecialFolders("AllUsersStartMenu"));

	WshShell.RegRead("HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Systemroot")

	WshShell.RegWrite("HKCU\\MyNewKey\\", 1 ,"REG_DWORD");
	WshShell.RegRead("HKCU\\MyNewKey\\");

	WshShell.RegRead("HKLM\\Not Existing\\");

	WshShell.RegRead("HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\ProgramFilesDir");

	var programfiles_path = WshShell.ExpandEnvironmentStrings("%PROGRAMFILES%")
	var notepad_lnk = WshShell.CreateShortcut(programfiles_path + "\\notepad.lnk")
	notepad_lnk.TargetPath = 'notepad.exe';
	notepad_lnk.save();

	var oExe = WshShell.Exec("calc.exe");
	alert("Exit Code: " + oExe.ExitCode);
	alert("Process ID: " + oExe.ProcessID);
	alert("Status: " + oExe.Status);
	alert(oExe.StdIn.AtEndOfStream);
	alert(oExe.StdOut.AtEndOfStream);
	alert(oExe.StdErr.AtEndOfStream);
	oExe.Terminate();

	WshShell.Popup("Title", 0, "This is a text message", 64);
	WshShell.Quit(1)
</script>
</body>
</html>
