<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configuration &mdash; Thug 4.8.1 documentation</title>
      <link rel="stylesheet" href="static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="static/documentation_options.js"></script>
        <script src="static/jquery.js"></script>
        <script src="static/underscore.js"></script>
        <script src="static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="static/doctools.js"></script>
        <script src="static/sphinx_highlight.js"></script>
    <script src="static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Usage" href="usage.html" />
    <link rel="prev" title="Docker" href="docker.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Thug
          </a>
              <div class="version">
                4.8.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Build and Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration-files">Configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#honeyagent-optional">HoneyAgent (optional)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Thug API</a></li>
<li class="toctree-l1"><a class="reference internal" href="jshooks.html">JS Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugin Framework</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Thug</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Configuration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="sources/configuration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="configuration">
<span id="id1"></span><h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="configuration-files">
<h2>Configuration files<a class="headerlink" href="#configuration-files" title="Permalink to this heading"></a></h2>
<p>Thug configuration files are automatically created during the installation
procedure. Be aware that the folder where such configuration files are
stored depends on the privileges of the user actually installing Thug.</p>
<p>Thug attempts to use the folder <em>/etc/thug/</em> at first. If such attempt fails
(reasonably because of a permission error) Thug reverts to a folder the user
is granted write permissions to. The folder selection is performed using appdirs
and these are usually the configuration folders selected on Linux and MacOS X</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>Linux<span class="w">    </span>/home/&lt;user&gt;/.config/thug
MacOS<span class="w"> </span>X<span class="w">  </span>/Users/&lt;user&gt;/Library/Application<span class="w"> </span>Support/thug
</pre></div>
</div>
<p>If you are not sure about the configuration folder path just run the following
command in your shell</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;exec(\&quot;import appdirs\nprint(appdirs.user_config_dir())\&quot;)&quot;</span>
/home/buffer/.config
</pre></div>
</div>
<p>Be aware that Thug will ignore the user configuration folder if the folder
<em>/etc/thug/</em> exists. The suggestion is to remove the folder <em>/etc/thug/</em> if it
already exists and revert to a user configuration folder. Installing Thug as
root is going to create it again. This could be exactly what you want in some
cases. If not, just install as a non privileged user.</p>
</div>
<div class="section" id="honeyagent-optional">
<h2>HoneyAgent (optional)<a class="headerlink" href="#honeyagent-optional" title="Permalink to this heading"></a></h2>
<p>HoneyAgent is a Java agent library that creates a sandbox for Java
applications and applets. It uses the JVMTI as well as the JNI to
intercept class loading and function calls.</p>
<p>During runtime HoneyAgent traces function calls performed by the
analyzed application. It shows which class calls which function
with which parameters. Reflected function calls are translated to
the original function names for simpler reading.</p>
<p>HoneyAgent provides simple means to hook individual Java functions
e.g. to provide fake values to the analyzed application. These hooks
are caller sensitive, so that default JRE classes can still function
properly. The process of class loading is also intercepted to identify
invalid bytecode and optionally make changes to get the class running
within the observed environment.</p>
<p>To sandbox the application, file accesses are redirected to a jailed
environment. Furthermore, Java properties as well as environment
variables are faked due to according Java function hooks.</p>
<p>HoneyAgent source code can be downloaded at</p>
<p><a class="reference external" href="https://bitbucket.org/fkie_cd_dare/honeyagent">https://bitbucket.org/fkie_cd_dare/honeyagent</a></p>
<p>It is HIGHLY suggested to run HoneyAgent in a dedicated VM because
there exists the possibility a sample could circumvent the sandbox
and compromise the machine. In such case please consider that a OVA
is available (and already configured) at</p>
<p><a class="reference external" href="https://www.dropbox.com/s/qieyfe97qvh7pjp/Honeyagent-r2.ova">https://www.dropbox.com/s/qieyfe97qvh7pjp/Honeyagent-r2.ova</a></p>
<p>Login   : thug
Password: thug</p>
<p>In order to configure Thug to submit applets for analysis to HoneyAgent
edit the configuration file <em>thug.conf</em> as shown later.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>honeyagent<span class="o">]</span>
scanurl:<span class="w">                        </span>http://192.168.56.101:8000
</pre></div>
</div>
<p>Please note that if the file <em>thug.conf</em> does not exists Thug will
assume you do not want to submit applets to HoneyAgent. Alternatively
you can disable the HoneyAgent support through command line even if the
the <em>thug.conf</em> file exists (option -N or –no-honeyagent).</p>
<p>This configuration instructs Thug to send the applet to analyze to the
server whose IP address is 192.168.56.101 (please verify your network
configuration and modify it accordingly) listening on port 8000/tcp.</p>
<p>In order to enable this service run this commands on the HoneyAgent
machine</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>thug@honeyagent:~$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>honeyagent/HoneyDaemon/
thug@honeyagent:~/honeyagent/HoneyDaemon$<span class="w"> </span>python<span class="w"> </span>daemon.py<span class="w"> </span>run.ini
HoneyAgent<span class="w"> </span>daemon<span class="w"> </span>running<span class="w"> </span>on<span class="w"> </span>port<span class="w"> </span><span class="m">8000</span>
</pre></div>
</div>
<p>After the service is enabled and properly configured you should be
able to automatically analyze applets like shown later.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>buffer@rigel<span class="w"> </span>~<span class="w"> </span>$<span class="w"> </span>thug<span class="w"> </span>http://192.168.0.100:8080/1
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:53<span class="o">]</span><span class="w"> </span><span class="o">[</span>window<span class="w"> </span>open<span class="w"> </span>redirection<span class="o">]</span><span class="w"> </span>about:blank<span class="w"> </span>-&gt;<span class="w"> </span>http://192.168.0.100:8080/1
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:53<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="w"> </span>Redirection<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">302</span><span class="o">)]</span><span class="w"> </span>Content-Location:<span class="w"> </span>http://192.168.0.100:8080/1<span class="w"> </span>--&gt;<span class="w"> </span>Location:<span class="w"> </span>http://192.168.0.100:8080/1/
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:53<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://192.168.0.100:8080/1/<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>None<span class="o">)</span>
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:53<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://192.168.0.100:8080/1/<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>text/html,<span class="w"> </span>MD5:<span class="w"> </span>514658fc397a7f227bd0d3e11b22c428<span class="o">)</span>
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:53<span class="o">]</span><span class="w"> </span>&lt;applet<span class="w"> </span><span class="nv">archive</span><span class="o">=</span><span class="s2">&quot;qqNqSoke.jar&quot;</span><span class="w"> </span><span class="nv">code</span><span class="o">=</span><span class="s2">&quot;BTrJ.class&quot;</span><span class="w"> </span><span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/applet&gt;
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:53<span class="o">]</span><span class="w"> </span><span class="o">[</span>Navigator<span class="w"> </span>URL<span class="w"> </span>Translation<span class="o">]</span><span class="w"> </span>qqNqSoke.jar<span class="w"> </span>--&gt;<span class="w"> </span>http://192.168.0.100:8080/1/qqNqSoke.jar
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:53<span class="o">]</span><span class="w"> </span><span class="o">[</span>applet<span class="w"> </span>redirection<span class="o">]</span><span class="w"> </span>http://192.168.0.100:8080/1/<span class="w"> </span>-&gt;<span class="w"> </span>http://192.168.0.100:8080/1/qqNqSoke.jar
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:53<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://192.168.0.100:8080/1/qqNqSoke.jar<span class="w"> </span><span class="o">(</span>Status:<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Referrer:<span class="w"> </span>http://192.168.0.100:8080/1/<span class="o">)</span>
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:53<span class="o">]</span><span class="w"> </span><span class="o">[</span>HTTP<span class="o">]</span><span class="w"> </span>URL:<span class="w"> </span>http://192.168.0.100:8080/1/qqNqSoke.jar<span class="w"> </span><span class="o">(</span>Content-type:<span class="w"> </span>application/octet-stream,<span class="w"> </span>MD5:<span class="w"> </span>1b3354f594522ff32791c278f50f2efa<span class="o">)</span>
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:56<span class="o">]</span><span class="w"> </span><span class="o">[</span>HoneyAgent<span class="o">][</span>1b3354f594522ff32791c278f50f2efa<span class="o">]</span><span class="w"> </span>Sample<span class="w"> </span>submitted
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:57<span class="o">]</span><span class="w"> </span><span class="o">[</span>HoneyAgent<span class="o">][</span>1b3354f594522ff32791c278f50f2efa<span class="o">]</span><span class="w"> </span>Dropped<span class="w"> </span>sample<span class="w"> </span>uAzpYJRZ.exe
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:57<span class="o">]</span><span class="w"> </span><span class="o">[</span>HoneyAgent<span class="o">][</span>1b3354f594522ff32791c278f50f2efa<span class="o">]</span><span class="w"> </span>Dropped<span class="w"> </span>sample<span class="w"> </span>IixfXAb.class
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:57<span class="o">]</span><span class="w"> </span><span class="o">[</span>HoneyAgent<span class="o">][</span>1b3354f594522ff32791c278f50f2efa<span class="o">]</span><span class="w"> </span>Dropped<span class="w"> </span>sample<span class="w"> </span>ArIBNUkvAi.dat
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:57<span class="o">]</span><span class="w"> </span><span class="o">[</span>HoneyAgent<span class="o">][</span>1b3354f594522ff32791c278f50f2efa<span class="o">]</span><span class="w"> </span>Yara<span class="w"> </span>heuristics<span class="w"> </span>rule<span class="w"> </span>CreatesNewProcess<span class="w"> </span>match
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:57<span class="o">]</span><span class="w"> </span><span class="o">[</span>HoneyAgent<span class="o">][</span>1b3354f594522ff32791c278f50f2efa<span class="o">]</span><span class="w"> </span>Yara<span class="w"> </span>heuristics<span class="w"> </span>rule<span class="w"> </span>WritesMZFile<span class="w"> </span>match
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:57<span class="o">]</span><span class="w"> </span><span class="o">[</span>HoneyAgent<span class="o">][</span>1b3354f594522ff32791c278f50f2efa<span class="o">]</span><span class="w"> </span>Yara<span class="w"> </span>heuristics<span class="w"> </span>rule<span class="w"> </span>WritesExeFile<span class="w"> </span>match
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:57<span class="o">]</span><span class="w"> </span><span class="o">[</span>HoneyAgent<span class="o">][</span>1b3354f594522ff32791c278f50f2efa<span class="o">]</span><span class="w"> </span>Yara<span class="w"> </span>heuristics<span class="w"> </span>rule<span class="w"> </span>LocalFileAccess<span class="w"> </span>match
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:57<span class="o">]</span><span class="w"> </span><span class="o">[</span>HoneyAgent<span class="o">][</span>1b3354f594522ff32791c278f50f2efa<span class="o">]</span><span class="w"> </span>Yara<span class="w"> </span>heuristics<span class="w"> </span>rule<span class="w"> </span>RestrictedPropertyAccess<span class="w"> </span>match
<span class="o">[</span><span class="m">2014</span>-07-07<span class="w"> </span><span class="m">23</span>:50:57<span class="o">]</span><span class="w"> </span>Saving<span class="w"> </span>log<span class="w"> </span>analysis<span class="w"> </span>at<span class="w"> </span>/tmp/thug/logs/97ae3a4c476f3efab64b70b26b0f7b57/20140707235053

buffer@rigel<span class="w"> </span>~<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/tmp/thug/logs/97ae3a4c476f3efab64b70b26b0f7b57/20140707235053/analysis/honeyagent/
buffer@rigel<span class="w"> </span>/tmp/thug/logs/97ae3a4c476f3efab64b70b26b0f7b57/20140707235053/analysis/honeyagent<span class="w"> </span>$<span class="w"> </span>ls<span class="w"> </span>-lhR
.:
total<span class="w"> </span>668K
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span>665K<span class="w"> </span>Jul<span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="m">23</span>:50<span class="w"> </span>1b3354f594522ff32791c278f50f2efa.json
drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w">   </span><span class="m">66</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="m">23</span>:50<span class="w"> </span>dropped

./dropped:
total<span class="w"> </span>92K
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w">  </span><span class="m">110</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="m">23</span>:50<span class="w"> </span>ArIBNUkvAi.dat
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w"> </span><span class="m">9</span>.2K<span class="w"> </span>Jul<span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="m">23</span>:50<span class="w"> </span>IixfXAb.class
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>buffer<span class="w"> </span>buffer<span class="w">  </span>73K<span class="w"> </span>Jul<span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="m">23</span>:50<span class="w"> </span>uAzpYJRZ.exe

buffer@rigel<span class="w"> </span>/tmp/thug/logs/97ae3a4c476f3efab64b70b26b0f7b57/20140707235053/analysis/honeyagent<span class="w"> </span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>dropped/
buffer@rigel<span class="w"> </span>/tmp/thug/logs/97ae3a4c476f3efab64b70b26b0f7b57/20140707235053/analysis/honeyagent/dropped<span class="w"> </span>$<span class="w"> </span>file<span class="w"> </span>*
ArIBNUkvAi.dat:<span class="w"> </span>ASCII<span class="w"> </span>text
IixfXAb.class:<span class="w">  </span>compiled<span class="w"> </span>Java<span class="w"> </span>class<span class="w"> </span>data,<span class="w"> </span>version<span class="w"> </span><span class="m">45</span>.3
uAzpYJRZ.exe:<span class="w">   </span>PE32<span class="w"> </span>executable<span class="w"> </span><span class="o">(</span>GUI<span class="o">)</span><span class="w"> </span>Intel<span class="w"> </span><span class="m">80386</span>,<span class="w"> </span><span class="k">for</span><span class="w"> </span>MS<span class="w"> </span>Windows
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="docker.html" class="btn btn-neutral float-left" title="Docker" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="usage.html" class="btn btn-neutral float-right" title="Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2023, Angelo Dell&#39;Aera.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>