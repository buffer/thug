<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Thug API &mdash; Thug 0.8.20 documentation</title>
    
    <link rel="stylesheet" href="static/classic.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.8.20',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="Thug 0.8.20 documentation" href="index.html" />
    <link rel="next" title="JS Hooks" href="jshooks.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="jshooks.html" title="JS Hooks"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Usage"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Thug 0.8.20 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="thug-api">
<span id="api"></span><h1>Thug API<a class="headerlink" href="#thug-api" title="Permalink to this headline">Â¶</a></h1>
<p>Thug provides a Python Application Program Interface (API) which can be used by external
tools to easily interface with Thug. Basic usage of the Thug API is simple and just
requires subclassing the ThugAPI class. Thug class (defined in <em>src/thug.py</em>) is a
great example of such basic usage and it clearly illustrates all the details that should
be needed in almost every scenario.</p>
<p>Using Thug API is really straightforward and the following example explains how to properly
make a basic use of the Thug API. Take a look at the interface definition below for more
advanced scenarios.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thug.ThugAPI</span> <span class="kn">import</span> <span class="n">ThugAPI</span>

<span class="k">class</span> <span class="nc">TestAPI</span><span class="p">(</span><span class="n">ThugAPI</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ThugAPI</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
        <span class="c1"># Set useragent to Internet Explorer 9.0 (Windows 7)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_useragent</span><span class="p">(</span><span class="s1">&#39;win7ie90&#39;</span><span class="p">)</span>

        <span class="c1"># Set referer to http://www.honeynet.org</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_referer</span><span class="p">(</span><span class="s1">&#39;http://www.honeynet.org&#39;</span><span class="p">)</span>

        <span class="c1"># Enable file logging mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_file_logging</span><span class="p">()</span>

        <span class="c1"># Enable JSON logging mode (requires file logging mode enabled)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_json_logging</span><span class="p">()</span>

        <span class="c1"># Enable MAEC 1.1 logging mode (requires file logging mode enabled)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_maec11_logging</span><span class="p">()</span>

        <span class="c1"># [IMPORTANT] The following three steps should be implemented (in the exact</span>
        <span class="c1"># order of this example) almost in every situation when you are going to</span>
        <span class="c1"># analyze a remote site.</span>

        <span class="c1"># Initialize logging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_init</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="c1"># Run analysis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_remote</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="c1"># Log analysis results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_event</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">TestAPI</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="s2">&quot;http://www.google.com&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Take a look at how the test suite automation scripts in <em>samples/steps/</em> directory make
use of the Thug API for an example of how to perform a local file analysis.</p>
<p>Thug API interface definition is reported below for convenience.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">IThugAPI</span><span class="p">(</span><span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">Interface</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">version</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print Thug version and exit</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_useragent</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_useragent</span>

<span class="sd">        Return the emulated user agent</span>

<span class="sd">        @return: user agent string</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_useragent</span><span class="p">(</span><span class="n">useragent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_useragent</span>

<span class="sd">        Set the user agent to emulate</span>

<span class="sd">        @param useragent: the user agent to emulate</span>
<span class="sd">        @type useragent: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_events</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_events</span>

<span class="sd">        Return the DOM events to emulate</span>
<span class="sd">        Note: the load and mousemove are emulated by default and are not included in</span>
<span class="sd">        the returned list</span>

<span class="sd">        @return: List of the DOM events to emulate</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_events</span><span class="p">(</span><span class="n">events</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_events</span>

<span class="sd">        Set the DOM events to emulate</span>
<span class="sd">        Note: the load and mousemove events are emulated by default and do not</span>
<span class="sd">        need to be added through set_events</span>

<span class="sd">        @param events: comma separated list of DOM events to emulate</span>
<span class="sd">        @type events: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_delay</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_delay</span>

<span class="sd">        Return the maximum setTimeout/setInterval delay value (in milliseconds)</span>

<span class="sd">        @return: maximum delay value (in milliseconds)</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_delay</span><span class="p">(</span><span class="n">delay</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_delay</span>

<span class="sd">        Set a maximum setTimeout/setInterval delay value (in milliseconds)</span>

<span class="sd">        @param delay: maximum delay value (in milliseconds)</span>
<span class="sd">        @type delay: C{int}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_file_logging</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_file_logging</span>

<span class="sd">        Return True if file logging mode is enabled, False otherwise.</span>

<span class="sd">        @return: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_file_logging</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_file_logging</span>

<span class="sd">        Enable file logging mode</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_json_logging</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_json_logging</span>

<span class="sd">        Return True if JSON logging mode is enabled, False otherwise.</span>

<span class="sd">        @return: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_json_logging</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_JSON_logging</span>

<span class="sd">        Enable JSON logging mode</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_maec11_logging</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_maec11_logging</span>

<span class="sd">        Return True if MAEC 1.1 logging mode is enabled, False otherwise.</span>

<span class="sd">        @return: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_maec11_logging</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_maec11_logging</span>

<span class="sd">        Enable MAEC 1.1 logging mode</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_referer</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_referer</span>

<span class="sd">        Return the emulated referer</span>

<span class="sd">        @return: referer value</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_referer</span><span class="p">(</span><span class="n">referer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_referer</span>

<span class="sd">        Set the referer to be emulated</span>

<span class="sd">        @param referer: referer</span>
<span class="sd">        @type referer: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_proxy</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_proxy</span>

<span class="sd">        Get the proxy server to be used for estabilishing the connection</span>

<span class="sd">        @return: proxy server</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_proxy</span><span class="p">(</span><span class="n">proxy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_proxy</span>

<span class="sd">        Set the proxy server to be used for estabilishing the connection</span>

<span class="sd">        @param proxy: proxy server</span>
<span class="sd">        @type proxy: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_no_fetch</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_no_fetch</span>

<span class="sd">        Prevent remote content fetching in any case</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_verbose</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_verbose</span>

<span class="sd">        Enable Thug verbose mode</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_debug</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_debug</span>

<span class="sd">        Enable Thug debug mode</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_no_cache</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_no_cache</span>

<span class="sd">        Disable local web cache</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_ast_debug</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_ast_debug</span>

<span class="sd">        Enable Thug AST debug mode</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_http_debug</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_http_debug</span>

<span class="sd">        Enable Thug HTTP debug mode</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_acropdf_pdf</span><span class="p">(</span><span class="n">acropdf_pdf</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_acropdf_pdf</span>

<span class="sd">        Set the Adobe Acrobat Reader version</span>

<span class="sd">        @param acropdf_pdf: Adobe Acrobat Reader version</span>
<span class="sd">        @type acropdf_pdf: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">disable_acropdf</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        disable_acropdf</span>

<span class="sd">        Disable Adobe Acrobat Reader</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_shockwave_flash</span><span class="p">(</span><span class="n">shockwave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_shockwave_flash</span>

<span class="sd">        Set the Shockwave Flash version (supported versions: 8, 9, 10, 11, 12)</span>

<span class="sd">        @param shockwave: Shockwave Flash version</span>
<span class="sd">        @type shockwave: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">disable_shockwave_flash</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        disable_shockwave_flash</span>

<span class="sd">        Disable Shockwave Flash</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_javaplugin</span><span class="p">(</span><span class="n">javaplugin</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_javaplugin</span>

<span class="sd">        Set the Java plugin version</span>

<span class="sd">        @param javaplugin: Java plugin version</span>
<span class="sd">        @type javaplugin: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">disable_javaplugin</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        disable_javaplugin</span>

<span class="sd">        Disable Java plugin</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_threshold</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_threshold</span>

<span class="sd">        Get the maximum number of pages to fetch</span>

<span class="sd">        @return: the maximum number of pages to fetch</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_threshold</span><span class="p">(</span><span class="n">threshold</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_threshold</span>

<span class="sd">        Set the maximum number of pages to fetch</span>

<span class="sd">        @param threshold: the maximum number of pages to fetch</span>
<span class="sd">        @type threshold: C{int}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_extensive</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_extensive</span>

<span class="sd">        Get the current extensive fetch of linked pages mode</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_extensive</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_extensive</span>

<span class="sd">        Set the extensive fetch of linked pages mode</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_connect_timeout</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_connect_timeout</span>

<span class="sd">        Get the connect timeout (in seconds)</span>

<span class="sd">        @return: the connect timeout (in seconds)</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_connect_timeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_connect_timeout</span>

<span class="sd">        Set the connect timeout (in seconds)</span>

<span class="sd">        @param timeout: the connect timeout (in seconds)</span>
<span class="sd">        @type timeout: C{int}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_timeout</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_timeout</span>

<span class="sd">        Get the analysis timeout (in seconds)</span>

<span class="sd">        @return: the analysis timeout (in seconds)</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_timeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_timeout</span>

<span class="sd">        Set the analysis timeout (in seconds)</span>

<span class="sd">        @param timeout: the analysis timeout (in seconds)</span>
<span class="sd">        @type timeout: C{int}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_broken_url</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_broken_url</span>

<span class="sd">        Get the broken URL mode</span>

<span class="sd">        @return mode: broken URL mode</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_broken_url</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_broken_url</span>

<span class="sd">        Set the broken URL mode</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">disable_honeyagent</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        disable_honeyagent</span>

<span class="sd">        Disable HoneyAgent Java sandbox analysis</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">enable_code_logging</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            enable_code_logging</span>

<span class="sd">            Enable code logging</span>

<span class="sd">            @return: None</span>
<span class="sd">            &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">disable_code_logging</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        disable_code_logging</span>

<span class="sd">        Disable code logging</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">enable_cert_logging</span><span class="p">():</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            enable_cert_logging</span>

<span class="sd">            Enable SSL/TLS certificate logging</span>

<span class="sd">            @return: None</span>
<span class="sd">            &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">disable_cert_logging</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        disable_cert_logging</span>

<span class="sd">        Disable SSL/TLS certificate logging</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">log_init</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        log_init</span>

<span class="sd">        Initialize logging subsystem</span>

<span class="sd">        @param url: URL to analyze</span>
<span class="sd">        @type url: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_log_dir</span><span class="p">(</span><span class="n">logdir</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_log_dir</span>

<span class="sd">        Set the log output directory</span>

<span class="sd">        @param logdir: the log output directory</span>
<span class="sd">        @type logdir: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_log_output</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_log_output</span>

<span class="sd">        Set the log output file</span>

<span class="sd">        @param output: the log output file</span>
<span class="sd">        @type output: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_log_quiet</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_log_quiet</span>

<span class="sd">        Disable console logging</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_vt_query</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_vt_query</span>

<span class="sd">        Enable VirusTotal queries for sample analysis</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_vt_submit</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_vt_submit</span>

<span class="sd">        Enable VirusTotal samples submit</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

     <span class="k">def</span> <span class="nf">get_vt_runtime_apikey</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_vt_runtime_apikey</span>

<span class="sd">        Get the VirusTotal API key set as runtime parameter (not the one defined in</span>
<span class="sd">        the configuration file)</span>

<span class="sd">        @return: string</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_vt_runtime_apikey</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_vt_runtime_apikey</span>

<span class="sd">        Set the key to be used when interacting with VirusTotal APIs, overriding</span>
<span class="sd">        any static value defined in virustotal.conf</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_mongodb_instance</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_mongodb_instance</span>

<span class="sd">        Get the address (&quot;host:port&quot;) of the MongoDB instance specified at runtime</span>
<span class="sd">        (not the one from the logging.conf file)</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_mongodb_instance</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_mongodb_instance</span>

<span class="sd">        Set the address (&quot;host:port&quot;) of a running MongoDB instance to be used at runtime</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get_web_tracking</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get_web_tracking</span>

<span class="sd">        Return True if web client tracking inspection is enabled, False otherwise.</span>

<span class="sd">        @return: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_web_tracking</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set_web_tracking</span>

<span class="sd">        Enable web client tracking inspection</span>

<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">add_urlclassifier</span><span class="p">(</span><span class="n">rule</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add_urlclassifier</span>

<span class="sd">        Add an additional URL classifier rule file</span>

<span class="sd">        @param rule: URL classifier rule file</span>
<span class="sd">        @type rule: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">add_htmlclassifier</span><span class="p">(</span><span class="n">rule</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add_htmlclassifier</span>

<span class="sd">        Add an additional HTML classifier rule file</span>

<span class="sd">        @param rule: HTML classifier rule file</span>
<span class="sd">        @type rule: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">add_jsclassifier</span><span class="p">(</span><span class="n">rule</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add_jsclassifier</span>

<span class="sd">        Add an additional JS classifier rule file</span>

<span class="sd">        @param rule: JS classifier rule file</span>
<span class="sd">        @type rule: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">add_sampleclassifier</span><span class="p">(</span><span class="n">rule</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add_sampleclassifier</span>

<span class="sd">        Add an additional Sample classifier rule file</span>

<span class="sd">        @param rule: Sample classifier rule file</span>
<span class="sd">        @type rule: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">add_urlfilter</span><span class="p">(</span><span class="nb">filter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add_urlfilter</span>

<span class="sd">        Add an additional URL filter file</span>

<span class="sd">        @param filter: URL filter file</span>
<span class="sd">        @type filter: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">add_htmlfilter</span><span class="p">(</span><span class="nb">filter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add_htmlfilter</span>

<span class="sd">        Add an additional HTML filter file</span>

<span class="sd">        @param filter: HTML filter file</span>
<span class="sd">        @type filter: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">add_jsfilter</span><span class="p">(</span><span class="nb">filter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add_jsfilter</span>

<span class="sd">        Add an additional JS filter file</span>

<span class="sd">        @param filter: JS filter file</span>
<span class="sd">        @type filter: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">add_samplefilter</span><span class="p">(</span><span class="nb">filter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add_samplefilter</span>

<span class="sd">        Add an additional sample filter file</span>

<span class="sd">        @param filter: Sample filter file</span>
<span class="sd">        @type filter: C{str}</span>
<span class="sd">        @return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">log_event</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        log_event</span>

<span class="sd">        Log the URL analysis results</span>

<span class="sd">        @return None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">run_local</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        run_local</span>

<span class="sd">        This method should be invoked by &#39;analyze&#39; method for local file analysis</span>

<span class="sd">        @param url: URL to analyze</span>
<span class="sd">        @type url: C{str}</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">run_remote</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        run_remote</span>

<span class="sd">        This method should be invoked by &#39;analyze&#39; method for URL analysis</span>

<span class="sd">        @param url: URL to analyze</span>
<span class="sd">        @type url: C{str}</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">analyze</span><span class="p">():</span>
        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        analyze</span>

<span class="s2">        This method is implicitely called when the ThugAPI instance is directly called</span>
<span class="s2">        (take a look at thug/thug.py for an example). It is a good practice to implement</span>
<span class="s2">        this method in any case as entry point and invoke it directly or by calling the</span>
<span class="s2">        instance (in such case implementing it is mandatory) on your requirements. This</span>
<span class="s2">        method can reference just  the (optional) &#39;args&#39; attribute. Returning something</span>
<span class="s2">        from this method is up to you if needed.</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="usage.html"
                        title="previous chapter">Usage</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="jshooks.html"
                        title="next chapter">JS Hooks</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="jshooks.html" title="JS Hooks"
             >next</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Usage"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Thug 0.8.20 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2011-2017, Angelo Dell&#39;Aera.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>